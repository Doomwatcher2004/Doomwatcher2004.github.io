<!doctype html>
<html lang="cn" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Java/Redis 数据结构操作入门" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Redis 数据结构操作入门 | 小冷の代码世界</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://doomwatcher2004.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://doomwatcher2004.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://doomwatcher2004.github.io/docs/Java/Redis 数据结构操作入门"><meta data-rh="true" property="og:locale" content="cn"><meta data-rh="true" name="docusaurus_locale" content="cn"><meta data-rh="true" name="docsearch:language" content="cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Redis 数据结构操作入门 | 小冷の代码世界"><meta data-rh="true" name="description" content="日常操作"><meta data-rh="true" property="og:description" content="日常操作"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doomwatcher2004.github.io/docs/Java/Redis 数据结构操作入门"><link data-rh="true" rel="alternate" href="https://doomwatcher2004.github.io/docs/Java/Redis 数据结构操作入门" hreflang="cn"><link data-rh="true" rel="alternate" href="https://doomwatcher2004.github.io/docs/Java/Redis 数据结构操作入门" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.15cbc4ab.css">
<script src="/assets/js/runtime~main.4abb65a5.js" defer="defer"></script>
<script src="/assets/js/main.7b9af782.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="小冷の代码世界" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="小冷の代码世界" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">小冷の代码世界</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Java/Docker 快速入门">Java知识库</a><a class="navbar__item navbar__link" href="/docs/Web/JavaScript 高级">前端知识库</a><a class="navbar__item navbar__link" href="/docs/Godot/">Godot游戏开发</a><a class="navbar__item navbar__link" href="/docs/finish/finishRpc">Finish系列手写中间件</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Doomwatcher2004" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Docker 快速入门">Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Java 8 更新的新特性 （函数式接口 lambda stream option）">Java8 新特性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Java后端进阶之路： JavaWeb">javaweb</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Mybatis">Mybatis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty+springboot实现IM即时通讯服务端">Netty+springboot实现IM即时通讯服务端</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty_HTTP文件列表服务器">Netty_HTTP文件列表服务器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty_模拟Redis的客户端">Netty_模拟Redis的客户端</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty网络框架">Netty 网络框架</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Nginx">Nginx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/Java/Redis 数据结构操作入门">Redis 数据结构操作入门</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Spring Aop 底层责任链思路实现">Spring Aop 底层责任链思路实现</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Spring5 Webflux 响应式编程">Spring5 Webflux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/SpringBoot 解决企业级复杂性简化开发的神奇">微服务阶段</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/SpringCloud Alibaba">springCloudAlibaba</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/SpringCloud Netflix">springcloud2020</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Spring内置MVC框架：SpringMVC">SpringMVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/mybatis plus">mybatis plus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/redis问题的常见解决方案">redis问题的常见解决方案</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/六道入门树题目带你走入树结构的世界">六道入门树题目带你走入树结构的世界</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/分布式项目中锁的应用（本地锁-redis【setnx】-redisson-springcache）">分布式项目中锁的应用（本地锁-redis【setnx】-redisson-springcache）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/多线程进阶 JUC并发编程">多线程进阶 JUC 并发编程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/大前端进阶（ES6）">ES6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/快速入门RabbitMQ并且加入项目实战">快速入门RabbitMQ并且加入项目实战</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/快速入门分布式系统与Dubbo+zookeeper">分布式系统简述：</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/掌握极简服务器开发的优秀框架 ：Spring">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/搜索引擎 _ Elasticsearch">Elasticsearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/数据结构与算法">数据结构与算法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/理解IOC 手写springIOC">Spring 手撕 IOC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/简易aiweb">Java入门Spring AI应用开发</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/线程池详解与异步任务编排使用案例">线程池详解与异步任务编排使用案例</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/通透百万数据秒级排序  快速排序">通透百万数据秒级排序  快速排序</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/阿里淘系单点登录中心">阿里淘系单点登录中心</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/高并发秒杀系统">高并发秒杀系统</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Redis 数据结构操作入门</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>redis</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="日常操作">日常操作<a href="#日常操作" class="hash-link" aria-label="Direct link to 日常操作" title="Direct link to 日常操作">​</a></h2>
<p>往日,大量的指令让我们无法只靠脑袋来完全的记住,于是乎,编写一个日常的 redis 常用命令文档,以备不时之需.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="redis-键key">Redis 键(key)<a href="#redis-键key" class="hash-link" aria-label="Direct link to Redis 键(key)" title="Direct link to Redis 键(key)">​</a></h3>
<ul>
<li><code>keys *</code> 查看当前库所有 key (匹配：keys *1)</li>
<li><code>exists </code>key 判断某个 key 是否存在</li>
<li><code>type key</code> 查看你的 key 是什么类型</li>
<li><code>del key</code> 删除指定的 key 数据</li>
<li><code>unlink key</code> 根据 value 选择非阻塞删除,仅将 keys 从 keyspace 元数据中删除，真正的删除会在后续异步操作。</li>
<li><code>expire key 10</code> 10 秒钟：为给定的 key 设置过期时间</li>
<li><code>ttl key</code> 查看还有多少秒过期，-1 表示永不过期，-2 表示已过期</li>
<li><code>select</code>命令切换数据库</li>
<li><code>dbsize</code>查看当前数据库的 key 的数量</li>
<li><code>flushdb</code>清空当前库</li>
<li><code>flushall</code>通杀全部库</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="redis-五个基本类型">Redis 五个基本类型<a href="#redis-五个基本类型" class="hash-link" aria-label="Direct link to Redis 五个基本类型" title="Direct link to Redis 五个基本类型">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="字符串string">字符串(String)<a href="#字符串string" class="hash-link" aria-label="Direct link to 字符串(String)" title="Direct link to 字符串(String)">​</a></h4>
<p>String 是 Redis 最基本的类型，你可以理解成与 Memcached 一模一样的类型，一个 key 对应一个 value。
String 类型是二进制安全的。意味着 Redis 的 string 可以包含任何数据。比如 jpg 图片或者序列化的对象。
String 类型是 Redis 最基本的数据类型，一个 Redis 中字符串 value 最多可以是 512M</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令">常用命令<a href="#常用命令" class="hash-link" aria-label="Direct link to 常用命令" title="Direct link to 常用命令">​</a></h5>
<blockquote>
<p>set <key><value>添加键值对<br>
*NX：当数据库中 key 不存在时，可以将 key-value 添加数据库
*XX：当数据库中 key 存在时，可以将 key-value 添加数据库，与 NX 参数互斥
*EX：key 的超时秒数
*PX：key 的超时毫秒数，与 EX 互斥</value></key></p>
<p>get <key>查询对应键值 append <key><value>将给定的<value> 追加到原值的末尾
strlen <key>获得值的长度 setnx <key><value>只有在 key 不存在时 设置 key 的值
incr <key> 将 key 中储存的数字值增 1 只能对数字值操作，如果为空，新增值为 1
decr <key> 将 key 中储存的数字值减 1 只能对数字值操作，如果为空，新增值为-1
incrby / decrby <key>&lt;步长&gt;将 key 中储存的数字值增减。自定义步长。</key></key></key></value></key></key></value></value></key></key></p>
<p>原子性 所谓原子操作是指不会被线程调度机制打断的操作； 这种操作一旦开始，就一直运行到结束，中间不会有任何 context switch （切换到另一个线程）。 （1）在单线程中，
能够在单条指令中完成的操作都可以认为是&quot;原子操作&quot;，因为中断只能发生于指令之间。
在多线程中，不能被其它进程（线程）打断的操作就叫原子操作。
mset <key1><value1><key2><value2> 同时设置一个或多个 key-value 对
mget <key1><key2><key3> ..... 同时获取一个或多个
value msetnx <key1><value1><key2><value2> ..... 同时设置一个或多个
key-value 对，当且仅当所有给定 key 都不存在。 原子性，有一个失败则都失败
getrange <key>&lt;起始位置&gt;&lt;结束位置&gt; 获得值的范围，类似 java 中的 substring，前包，后包
setrange <key>&lt;起始位置&gt;<value> 用 <value> 覆写<key>所储存的字符串值，从&lt;起始位置&gt;开始(索引从 0 开始)。
setex <key>&lt;过期时间&gt;<value> 设置键值的同时，设置过期时间，单位秒。 getset <key><value>
以新换旧，设置了新值同时获得旧值。</value></key></value></key></key></value></value></key></key></value2></key2></value1></key1></key3></key2></key1></value2></key2></value1></key1></p>
</blockquote>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="数据结构">数据结构<a href="#数据结构" class="hash-link" aria-label="Direct link to 数据结构" title="Direct link to 数据结构">​</a></h5>
<p>String 的数据结构为简单动态字符串(Simple Dynamic String,缩写 SDS)。是可以修改的字符串，内部结构实现上类似于 Java 的 ArrayList，采用预分配冗余空间的方式来减少内存的频繁分配.
内部为当前字符串实际分配的空间 capacity 一般要高于实际字符串长度 len。当字符串长度小于 1M 时，扩容都是加倍现有的空间，如果超过 1M，扩容时一次只会多扩 1M 的空间。需要注意的是字符串最大长度为 512M。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="redis-列表list">Redis 列表(List)<a href="#redis-列表list" class="hash-link" aria-label="Direct link to Redis 列表(List)" title="Direct link to Redis 列表(List)">​</a></h4>
<p>单键多值
Redis 列表是简单的字符串列表，按照插入顺序排序。你可以添加一个元素到列表的头部（左边）或者尾部（右边）。
它的底层实际是个双向链表，对两端的操作性能很高，通过索引下标的操作中间的节点性能会较差。
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d50779cc32c5471a90423259b4289b2c.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-1">常用命令<a href="#常用命令-1" class="hash-link" aria-label="Direct link to 常用命令" title="Direct link to 常用命令">​</a></h5>
<blockquote>
<p>lpush/rpush <key><value1><value2><value3> .... 从左边/右边插入一个或多个值。
lpop/rpop <key>从左边/右边吐出一个值。值在键在，值光键亡。
rpoplpush <key1><key2>从<key1>列表右边吐出一个值，插到<key2>列表左边。
lrange <key><start><stop>按照索引下标获得元素(从左到右)
lrange mylist 0 -1 0 左边第一个，-1 右边第一个，（0-1 表示获取所有）
lindex <key><index>按照索引下标获得元素(从左到右)
llen <key>获得列表长度
linsert <key> before <value><newvalue>在<value>的后面插入<newvalue>插入值
lrem <key><n><value>从左边删除 n 个 value(从左到右)
lset<key><index><value>将列表 key 下标为 index 的值替换成 value</value></index></key></value></n></key></newvalue></value></newvalue></value></key></key></index></key></stop></start></key></key2></key1></key2></key1></key></value3></value2></value1></key></p>
</blockquote>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="数据结构-1">数据结构<a href="#数据结构-1" class="hash-link" aria-label="Direct link to 数据结构" title="Direct link to 数据结构">​</a></h5>
<p>List 的数据结构为快速链表 quickList。
首先在列表元素较少的情况下会使用一块连续的内存存储，这个结构是 ziplist，也即是压缩列表。
它将所有的元素紧挨着一起存储，分配的是一块连续的内存。
当数据量比较多的时候才会改成 quicklist。
因为普通的链表需要的附加指针空间太大，会比较浪费空间。比如这个列表里存的只是 int 类型的数据，结构上还需要两个额外的指针 prev 和 next。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/f276ed13c05d414fb27101ddacdcf2a4.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<p>Redis 将链表和 ziplist 结合起来组成了 quicklist。也就是将多个 ziplist 使用双向指针串起来使用。这样既满足了快速的插入删除性能，又不会出现太大的空间冗余。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="redis-集合set">Redis 集合(Set)<a href="#redis-集合set" class="hash-link" aria-label="Direct link to Redis 集合(Set)" title="Direct link to Redis 集合(Set)">​</a></h4>
<p>Redis set 对外提供的功能与 list 类似是一个列表的功能，特殊之处在于 set 是可以自动排重的，当你需要存储一个列表数据，又不希望出现重复数据时，set 是一个很好的选择，并且 set 提供了判断某个成员是否在一个 set 集合内的重要接口，这个也是 list 所不能提供的。
Redis 的 Set 是 string 类型的无序集合。它底层其实是一个 value 为 null 的 hash 表，所以添加，删除，查找的复杂度都是 O(1)。
一个算法，随着数据的增加，执行时间的长短，如果是 O(1)，数据增加，查找数据的时间不变</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-2">常用命令<a href="#常用命令-2" class="hash-link" aria-label="Direct link to 常用命令" title="Direct link to 常用命令">​</a></h5>
<blockquote>
<p>sadd <key><value1><value2> .....
将一个或多个 member 元素加入到集合 key 中，已经存在的 member 元素将被忽略
smembers <key>取出该集合的所有值。
sismember <key><value>判断集合<key>是否为含有该<value>值，有 1，没有 0
scard<key>返回该集合的元素个数。
srem <key><value1><value2> .... 删除集合中的某个元素。
spop <key>随机从该集合中吐出一个值。
srandmember <key><n>随机从该集合中取出 n 个值。不会从集合中删除 。
smove <source><destination>value 把集合中一个值从一个集合移动到另一个集合
sinter <key1><key2>返回两个集合的交集元素。
sunion <key1><key2>返回两个集合的并集元素。
sdiff <key1><key2>返回两个集合的差集元素(key1 中的，不包含 key2 中的)</key2></key1></key2></key1></key2></key1></destination></n></key></key></value2></value1></key></key></value></key></value></key></key></value2></value1></key></p>
</blockquote>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="数据结构-2">数据结构<a href="#数据结构-2" class="hash-link" aria-label="Direct link to 数据结构" title="Direct link to 数据结构">​</a></h5>
<p>Set 数据结构是 dict 字典，字典是用哈希表实现的。
Java 中 HashSet 的内部实现使用的是 HashMap，只不过所有的 value 都指向同一个对象。Redis 的 set 结构也是一样，它的内部也使用 hash 结构，所有的 value 都指向同一个内部值。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="redis-哈希hash">Redis 哈希(Hash)<a href="#redis-哈希hash" class="hash-link" aria-label="Direct link to Redis 哈希(Hash)" title="Direct link to Redis 哈希(Hash)">​</a></h4>
<p>Redis hash 是一个键值对集合。
Redis hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象。
类似 Java 里面的 Map&lt;String,Object&gt;
用户 ID 为查找的 key，存储的 value 用户对象包含姓名，年龄，生日等信息，如果用普通的 key/value 结构来存储
主要有以下 2 种存储方式：
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAZG9vbXdhdGNoZXI=,size_20,color_FFFFFF,t_70,g_se,x_16.png" alt="在这里插入图片描述" class="img_ev3q">
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAZG9vbXdhdGNoZXI=,size_15,color_FFFFFF,t_70,g_se,x_16.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<p>通过 key(用户 ID) + field(属性标签) 就可以操作对应属性数据了，既不需要重复存储数据，也不会带来序列化和并发修改控制的问题</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">hset</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">给</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">集合中的</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">          </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">键赋值</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            hget</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">              </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">从</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">集合</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">取出 value hmset</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">field1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                          </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">field2</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                            </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value2</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                              </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">... 批量设置hash的值 hexists</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">查看哈希表 key 中，给定域 field 是否存在。</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                  hkeys</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                  </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">列出该hash集合的所有field hvals</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                    </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">列出该hash集合的所有value hincrby</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                      </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                          </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">increment</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                            </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">为哈希表 key 中的域 field</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                            的值加上增量 1 -1 hsetnx</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                            </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                              </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                                </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                                  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">将哈希表 key 中的域 field</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                  的值设置为 value ，当且仅当域</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                  field 不存在 .</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                                </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                              </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                            </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">increment</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                          </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                              </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value2</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                            </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">field2</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                          </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">field1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">              </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">            </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">          </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">field</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9"></span><span class="token tag punctuation" style="color:#475569">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="数据结构-3">数据结构<a href="#数据结构-3" class="hash-link" aria-label="Direct link to 数据结构" title="Direct link to 数据结构">​</a></h5>
<p>Hash 类型对应的数据结构是两种：ziplist（压缩列表），hashtable（哈希表）。当 field-value 长度较短且个数较少时，使用 ziplist，否则使用 hashtable。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="redis-有序集合-zsetsorted-set">Redis 有序集合 Zset(sorted set)<a href="#redis-有序集合-zsetsorted-set" class="hash-link" aria-label="Direct link to Redis 有序集合 Zset(sorted set)" title="Direct link to Redis 有序集合 Zset(sorted set)">​</a></h4>
<p>Redis 有序集合 zset 与普通集合 set 非常相似，是一个没有重复元素的字符串集合。
不同之处是有序集合的每个成员都关联了一个评分（score）,这个评分（score）被用来按照从最低分到最高分的方式排序集合中的成员。集合的成员是唯一的，但是评分可以是重复了 。
因为元素是有序的, 所以你也可以很快的根据评分（score）或者次序（position）来获取一个范围的元素。
访问有序集合的中间元素也是非常快的,因此你能够使用有序集合作为一个没有重复成员的智能列表</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="常用命令-3">常用命令<a href="#常用命令-3" class="hash-link" aria-label="Direct link to 常用命令" title="Direct link to 常用命令">​</a></h5>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">zadd</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">score1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">score2</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value2</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">          </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">… 将一个或多个 member 元素及其 score 值加入到有序集 key 当中。 zrange</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">            </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">start</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">              </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">stop</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                [WITHSCORES] 返回有序集 key中，下标在</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">start</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">stop</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">之间的元素 带WITHSCORES，可以让分数一起和值返回到结果集。</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    zrangebyscore key minmax [withscores] [limit offset count]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    返回有序集 key 中， 所有 score 值介于 min和 max</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    之间(包括等于 min 或 max )的成员。 有序集成员按 score</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    值递增(从小到大)次序排列。 zrevrangebyscore key maxmin</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    [withscores] [limit offset count] 同上，改为从大到小排列。</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    zincrby</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">increment</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                          为元素的score加上增量 zrem</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                          </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                            </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                              </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">删除该集合下，指定值的元素 zcount</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                              </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">min</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">max</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">统计该集合， 分数区间内的元素个数 zrank</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                    </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">返回该值在集合中的排名，从0开始。</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">max</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">min</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                                </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                              </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                            </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                          </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">increment</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">stop</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">start</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">                </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">stop</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">              </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">start</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">            </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">          </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value2</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">        </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">score2</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">score1</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9"></span><span class="token tag punctuation" style="color:#475569">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="数据结构-4">数据结构<a href="#数据结构-4" class="hash-link" aria-label="Direct link to 数据结构" title="Direct link to 数据结构">​</a></h5>
<p>SortedSet(zset)是 Redis 提供的一个非常特别的数据结构，一方面它等价于 Java 的数据结构 Map&lt;String, Double&gt;，可以给每一个元素 value 赋予一个权重 score，另一方面它又类似于 TreeSet，内部的元素会按照权重 score 进行排序，可以得到每个元素的名次，还可以通过 score 的范围来获取元素的列表。
zset 底层使用了两个数据结构
（1）hash，hash 的作用就是关联元素 value 和权重 score，保障元素 value 的唯一性，可以通过元素 value 找到相应的 score 值。
（2）跳跃表，跳跃表的目的在于给元素 value 排序，根据 score 的范围获取元素列表。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="redis-新数据类型">Redis 新数据类型<a href="#redis-新数据类型" class="hash-link" aria-label="Direct link to Redis 新数据类型" title="Direct link to Redis 新数据类型">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="bitmaps">Bitmaps<a href="#bitmaps" class="hash-link" aria-label="Direct link to Bitmaps" title="Direct link to Bitmaps">​</a></h4>
<p>现代计算机用二进制（位） 作为信息的基础单位， 1 个字节等于 8 位， 例如“abc”字符串是由 3 个字节组成， 但实际在计算机存储时将其用二进制表示， “abc”分别对应的 ASCII 码分别是 97、 98、 99， 对应的二进制分别是 01100001、 01100010 和 01100011，
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/488ef6c9541d4f87a642e9fb73695a3c.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<p>合理地使用操作位能够有效地提高内存使用率和开发效率。
Redis 提供了 Bitmaps 这个“数据类型”可以实现对位的操作：
（1） Bitmaps 本身不是一种数据类型， 实际上它就是字符串（key-value） ， 但是它可以对字符串的位进行操作。
（2） Bitmaps 单独提供了一套命令， 所以在 Redis 中使用 Bitmaps 和使用字符串的方法不太相同。 可以把 Bitmaps 想象成一个以位为单位的数组， 数组的每个单元只能存储 0 和 1， 数组的下标在 Bitmaps 中叫做偏移量。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="命令">命令<a href="#命令" class="hash-link" aria-label="Direct link to 命令" title="Direct link to 命令">​</a></h5>
<p>setbit</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">setbit</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">offset</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">      </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">设置Bitmaps中某个偏移量的值（0或1） *offset:偏移量从0开始</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">value</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">offset</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9"></span><span class="token tag punctuation" style="color:#475569">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>实例
每个独立用户是否访问过网站存放在 Bitmaps 中， 将访问的用户记做 1， 没有访问的用户记做 0， 用偏移量作为用户的 id。</p>
<p>getbit</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">getbit</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">offset</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">    </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">获取Bitmaps中某个偏移量的值 获取键的第offset位的值（从0开始算）</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">offset</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9">  </span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag" style="color:#0ea5e9"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token tag" style="color:#0ea5e9"></span><span class="token tag punctuation" style="color:#475569">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>实例
获取 id=8 的用户是否在 2020-11-06 这天访问过， 返回 0 说明没有访问过
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/3152f3f46b0045ec978cf034e9fca33c.png" alt="在这里插入图片描述" class="img_ev3q">
bitcount
统计字符串被设置为 1 的 bit 数。一般情况下，给定的整个字符串都会被进行计数，通过指定额外的 start 或 end 参数，可以让计数只在特定的位上进行。start 和 end 参数的设置，都可以使用负数值：比如 -1 表示最后一个位，而 -2 表示倒数第二个位，start、end 是指 bit 组的字节的下标数，二者皆包含。</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">bitcount</span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">[start end] 统计字符串从start字节到end字节比特值为1的数量</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">key</span><span class="token tag punctuation" style="color:#475569">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>例子 : 计算 2022-11-06 这天的独立访问用户数量
start 和 end 代表起始和结束字节数， 下面操作计算用户 id 在第 1 个字节到第 3 个字节之间的独立访问用户数， 对应的用户 id 是 11， 15， 19。
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/a31f7850fe2d417590534e840feb259f.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="bitmaps-与-set-对比">Bitmaps 与 set 对比<a href="#bitmaps-与-set-对比" class="hash-link" aria-label="Direct link to Bitmaps 与 set 对比" title="Direct link to Bitmaps 与 set 对比">​</a></h5>
<p>假设网站有 1 亿用户， 每天独立访问的用户有 5 千万， 如果每天用集合类型和 Bitmaps 分别存储活跃用户可以得到表
set 和 Bitmaps 存储一天活跃用户对比</p>
<p>集合类型 64 位 50000000 64 位*50000000 = 400MB</p>
<p>Bitmaps 1 位 100000000 1 位*100000000 = 12.5MB</p>
<p>很明显， 这种情况下使用 Bitmaps 能节省很多的内存空间， 尤其是随着时间推移节省的内存还是非常可观的
set 和 Bitmaps 存储独立用户空间对比 一天 一个月 一年</p>
<p>集合类型 400MB 12GB 144GB
Bitmaps 12.5MB 375MB 4.5GB</p>
<p>但 Bitmaps 并不是万金油， 假如该网站每天的独立访问用户很少， 例如只有 10 万（大量的僵尸用户） ， 那么两者的对比如下表所示， 很显然， 这时候使用 Bitmaps 就不太合适了， 因为基本上大部分位都是 0。
set 和 Bitmaps 存储一天活跃用户对比（独立用户比较少）</p>
<p>数据类型 每个 userid 占用空间 需要存储的用户量 全部内存量
集合类型 64 位 100000 64 位<em>100000 = 800KB
Bitmaps 1 位 100000000 1 位</em>100000000 = 12.5MB</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="hyperloglog">HyperLogLog<a href="#hyperloglog" class="hash-link" aria-label="Direct link to HyperLogLog" title="Direct link to HyperLogLog">​</a></h4>
<p>在工作当中，我们经常会遇到与统计相关的功能需求，比如统计网站 PV（PageView 页面访问量）,可以使用 Redis 的 incr、incrby 轻松实现。
但像 UV（UniqueVisitor，独立访客）、独立 IP 数、搜索记录数等需要去重和计数的问题如何解决？这种求集合中不重复元素个数的问题称为基数问题。
解决基数问题有很多种方案：
（1）数据存储在 MySQL 表中，使用 distinct count 计算不重复个数
（2）使用 Redis 提供的 hash、set、bitmaps 等数据结构来处理
以上的方案结果精确，但随着数据不断增加，导致占用空间越来越大，对于非常大的数据集是不切实际的。
能否能够降低一定的精度来平衡存储空间？Redis 推出了 HyperLogLog
Redis HyperLogLog 是用来做基数统计的算法，HyperLogLog 的优点是，在输入元素的数量或者体积非常非常大时，计算基数所需的空间总是固定的、并且是很小的。
在 Redis 里面，每个 HyperLogLog 键只需要花费 12 KB 内存，就可以计算接近 2^64 个不同元素的基数。这和计算基数时，元素越多耗费内存就越多的集合形成鲜明对比。
但是，因为 HyperLogLog 只会根据输入元素来计算基数，而不会储存输入元素本身，所以 HyperLogLog 不能像集合那样，返回输入的各个元素。</p>
<p>什么是基数?
比如数据集 {1, 3, 5, 7, 5, 7, 8}， 那么这个数据集的基数集为 {1, 3, 5 ,7, 8}, 基数(不重复元素)为 5。 基数估计就是在误差可接受的范围内，快速计算基数。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="命令-1">命令<a href="#命令-1" class="hash-link" aria-label="Direct link to 命令" title="Direct link to 命令">​</a></h5>
<p><strong>pfadd</strong>
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/86615859dcb24b44ba04f949ef96d937.png" alt="在这里插入图片描述" class="img_ev3q">
pfadd <key>&lt; element&gt; [element ...] 添加指定元素到 HyperLogLog 中
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/074a7a2470994db2b8ae303f37fbe0e8.png" alt="在这里插入图片描述" class="img_ev3q">
将所有元素添加到指定 HyperLogLog 数据结构中。如果执行命令后 HLL 估计的近似基数发生变化，则返回 1，否则返回 0。</key></p>
<p><strong>pfcount</strong>
pfcount<key> [key ...] 计算 HLL 的近似基数，可以计算多个 HLL，比如用 HLL 存储每天的 UV，计算一周的 UV 可以使用 7 天的 UV 合并计算即可
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d55e6aa08caa4836b13950986a123fd3.png" alt="在这里插入图片描述" class="img_ev3q">
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/58443cd7462149eaac927dd7902d3e98.png" alt="在这里插入图片描述" class="img_ev3q"></key></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="geospatial">Geospatial<a href="#geospatial" class="hash-link" aria-label="Direct link to Geospatial" title="Direct link to Geospatial">​</a></h4>
<p>Redis 3.2 中增加了对 GEO 类型的支持。GEO，Geographic，地理信息的缩写。该类型，就是元素的 2 维坐标，在地图上就是经纬度。redis 基于该类型，提供了经纬度设置，查询，范围查询，距离查询，经纬度 Hash 等常见操作。</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="命令-2">命令<a href="#命令-2" class="hash-link" aria-label="Direct link to 命令" title="Direct link to 命令">​</a></h5>
<p><strong>geoadd</strong>
geoadd<key>&lt; longitude&gt;<latitude><member> [longitude latitude member...] 添加地理位置（经度，纬度，名称）
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/dd6b67bb33c44942930875f10e76745f.png" alt="在这里插入图片描述" class="img_ev3q">
实例
geoadd china:city 121.47 31.23 shanghai
geoadd china:city 106.50 29.53 chongqing 114.05 22.52 shenzhen 116.38 39.90 beijing
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/0621aac8a0914330ae5332415a00d077.png" alt="在这里插入图片描述" class="img_ev3q"></member></latitude></key></p>
<p>两极无法直接添加，一般会下载城市数据，直接通过 Java 程序一次性导入。
有效的经度从 -180 度到 180 度。有效的纬度从 -85.05112878 度到 85.05112878 度。
当坐标位置超出指定范围时，该命令将会返回一个错误。
已经添加的数据，是无法再次往里面添加的。</p>
<p><strong>geopos</strong><br>
geopos <key><member> [member...] 获得指定地区的坐标值
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/8eefcd2c778c4a6fabe8eeac1f2c98e3.png" alt="在这里插入图片描述" class="img_ev3q">
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/475b193d57994ca8a5070612781df566.png" alt="在这里插入图片描述" class="img_ev3q">
<strong>geodist</strong>
geodist<key><member1><member2> [m|km|ft|mi ] 获取两个位置之间的直线距离
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/7b558540fdd643c2bd0c5fb414ad603c.png" alt="在这里插入图片描述" class="img_ev3q">
获取两个位置之间的直线距离
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d7ea4bf0e9544d88a1eb0dbc00c0d5bf.png" alt="在这里插入图片描述" class="img_ev3q">
单位：
m 表示单位为米[默认值]。
km 表示单位为千米。
mi 表示单位为英里。
ft 表示单位为英尺。
如果用户没有显式地指定单位参数， 那么 GEODIST 默认使用米作为单位</member2></member1></key></member></key></p>
<p><strong>georadius</strong></p>
<p>georadius<key>&lt; longitude&gt;<latitude>radius m|km|ft|mi 以给定的经纬度为中心，找出某一半径内的元素,经度 纬度 距离 单位
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/3afeba4320724c8fa78b9e3a0c326620.png" alt="在这里插入图片描述" class="img_ev3q">
实例
<img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/c71523cd26ac4220a5a8bdbe11c97662.png" alt="在这里插入图片描述" class="img_ev3q"></latitude></key></p>
<p>以上便是 redis 数据结构的应用场景和常用命令和实例.需要用到的时候来翻阅一手,解决背书烦恼</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Java/Nginx"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Nginx</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Java/Spring Aop 底层责任链思路实现"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Spring Aop 底层责任链思路实现</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#日常操作" class="table-of-contents__link toc-highlight">日常操作</a><ul><li><a href="#redis-键key" class="table-of-contents__link toc-highlight">Redis 键(key)</a></li><li><a href="#redis-五个基本类型" class="table-of-contents__link toc-highlight">Redis 五个基本类型</a></li><li><a href="#redis-新数据类型" class="table-of-contents__link toc-highlight">Redis 新数据类型</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">  来自冷环渊的技术支持与文档创作 @2025</div></div></div></footer></div>
</body>
</html>