<!doctype html>
<html lang="cn" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Java/Docker 快速入门" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Docker | 小冷の代码世界</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://doomwatcher2004.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://doomwatcher2004.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://doomwatcher2004.github.io/docs/Java/Docker 快速入门"><meta data-rh="true" property="og:locale" content="cn"><meta data-rh="true" name="docusaurus_locale" content="cn"><meta data-rh="true" name="docsearch:language" content="cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Docker | 小冷の代码世界"><meta data-rh="true" name="description" content="Docker"><meta data-rh="true" property="og:description" content="Docker"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doomwatcher2004.github.io/docs/Java/Docker 快速入门"><link data-rh="true" rel="alternate" href="https://doomwatcher2004.github.io/docs/Java/Docker 快速入门" hreflang="cn"><link data-rh="true" rel="alternate" href="https://doomwatcher2004.github.io/docs/Java/Docker 快速入门" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.15cbc4ab.css">
<script src="/assets/js/runtime~main.effe0063.js" defer="defer"></script>
<script src="/assets/js/main.00c018b0.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="小冷の代码世界" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="小冷の代码世界" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">小冷の代码世界</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Java/Docker 快速入门">Java知识库</a><a class="navbar__item navbar__link" href="/docs/Web/JavaScript 高级">前端知识库</a><a class="navbar__item navbar__link" href="/docs/Godot/">Godot游戏开发</a><a class="navbar__item navbar__link" href="/docs/finish/finishRpc">原创Java微服务生态</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Doomwatcher2004" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/Java/Docker 快速入门">Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Java 8 更新的新特性 （函数式接口 lambda stream option）">Java8 新特性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Java后端进阶之路： JavaWeb">javaweb</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Mybatis">Mybatis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty+springboot实现IM即时通讯服务端">Netty+springboot实现IM即时通讯服务端</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty_HTTP文件列表服务器">Netty_HTTP文件列表服务器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty_模拟Redis的客户端">Netty_模拟Redis的客户端</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty网络框架">Netty 网络框架</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Nginx">Nginx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Redis 数据结构操作入门">Redis 数据结构操作入门</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Spring Aop 底层责任链思路实现">Spring Aop 底层责任链思路实现</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Spring5 Webflux 响应式编程">Spring5 Webflux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/SpringBoot 解决企业级复杂性简化开发的神奇">微服务阶段</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/SpringCloud Alibaba">springCloudAlibaba</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/SpringCloud Netflix">springcloud2020</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Spring内置MVC框架：SpringMVC">SpringMVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/mybatis plus">mybatis plus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/redis问题的常见解决方案">redis问题的常见解决方案</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/使用Netty+zookeeper开发一款高性能LRpc">RPC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/六道入门树题目带你走入树结构的世界">六道入门树题目带你走入树结构的世界</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/分布式项目中锁的应用（本地锁-redis【setnx】-redisson-springcache）">分布式项目中锁的应用（本地锁-redis【setnx】-redisson-springcache）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/多线程进阶 JUC并发编程">多线程进阶 JUC 并发编程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/大前端进阶（ES6）">ES6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/快速入门RabbitMQ并且加入项目实战">快速入门RabbitMQ并且加入项目实战</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/快速入门分布式系统与Dubbo+zookeeper">分布式系统简述：</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/掌握极简服务器开发的优秀框架 ：Spring">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/搜索引擎 _ Elasticsearch">Elasticsearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/数据结构与算法">数据结构与算法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/理解IOC 手写springIOC">Spring 手撕 IOC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/线程池详解与异步任务编排使用案例">线程池详解与异步任务编排使用案例</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/通透百万数据秒级排序  快速排序">通透百万数据秒级排序  快速排序</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/阿里淘系单点登录中心">阿里淘系单点登录中心</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/高并发秒杀系统">高并发秒杀系统</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Docker</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Docker</h1></header>
<blockquote>
<p>Docker</p>
</blockquote>
<p>docker 是什么，docker 的用处，以前是必须会 spring，现在高级的工程师需要掌握 docker</p>
<blockquote>
<p>如何学习 docker</p>
</blockquote>
<ul>
<li>Docker 概述</li>
<li>docker 安装</li>
<li>docker 命令
<ul>
<li>镜像命令</li>
<li>容器命令</li>
<li>操作命令</li>
<li>等等</li>
</ul>
</li>
<li>docker 镜像</li>
<li>容器数据卷</li>
<li>dockerfile</li>
<li>docker 网络原理</li>
<li>docker 整合 idea</li>
<li>docker compose</li>
<li>docker swarm</li>
<li>DI/CD jenkins</li>
</ul>
<p>知道的越多，不知道的越多</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker-概述">docker 概述<a href="#docker-概述" class="hash-link" aria-label="Direct link to docker 概述" title="Direct link to docker 概述">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-为什么出现">docker 为什么出现？<a href="#docker-为什么出现" class="hash-link" aria-label="Direct link to docker 为什么出现？" title="Direct link to docker 为什么出现？">​</a></h3>
<p>一款产品：开发--上线 两套环境， 两套配置</p>
<p>开发 和 运维 问题：在我的电脑上可以运行，版本更新，导致服务不可用！对于运维来说，考验十分的大</p>
<p>开发即是运维的情况下更是如此，每一个机器都要部署环境，浪费时间和人力，容器化，项目带着环境来打包，配置很麻烦，也有部分不能跨平台比如开发 win，打包到 linux</p>
<p>传统思想 : 开发 jar 运维来做</p>
<p>现在 : 开发打包部署上线，一套流程做完</p>
<blockquote>
<p>为什么 docker 厉害？</p>
</blockquote>
<p>java --apk --发布 --- 张三使用 apk --- 安装即可用！</p>
<p>java ---jar ---打包项目带上环境（镜像） --- （docker 仓库镜像）--下载开发人员上传的镜像 -- 直接就可以运行</p>
<p>docker 根据以上的问题给出了解决方案</p>
<p>docker 的思想来自于集装箱</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/202305081810893.png" alt="image-20211006142006627" class="img_ev3q"></p>
<p>JRE - -多个应用---原来是交叉的</p>
<p>docker 的核心思想 ： 隔离，打包装箱，每个箱子都是互相隔离的</p>
<p>Docker 通过隔离机制，让服务器更好的发挥</p>
<p>本质 ： 所有的技术都是出现了问题，我们需要去解决</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker-的历史和作用">Docker 的历史和作用<a href="#docker-的历史和作用" class="hash-link" aria-label="Direct link to Docker 的历史和作用" title="Direct link to Docker 的历史和作用">​</a></h2>
<p>2010，几个搞 it 的年轻人，最开始的时候并不叫 Docker <code>dotcloud</code></p>
<p>做一些 pass 的云计算服务，LXC 有关的容器技术</p>
<p>他们将自己的技术（容器化技术）同一的命名为 Docker</p>
<p>应为刚诞生所以没什么基础，于是乎领导人们选择了将 Docker 的源码开放</p>
<p>开源之后的 Docker 一瞬间就火了</p>
<p>为什么 Docker 火起来了，应为相比虚拟机，Docker 要更加的轻量</p>
<blockquote>
<p>虚拟机 :</p>
</blockquote>
<p>​ 一般都是再 win 中安装 Vmware 通过这个技术我们可以虚拟出来一台电脑或者是多台电脑，但是占用过大，随便一个镜像就是十几个 g，十分的笨重</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/202305081811097.png" alt="image-20211006143537787" class="img_ev3q"></p>
<p>虚拟机技术的缺点：</p>
<ol>
<li>资源占用十分多</li>
<li>开机关机需要时间</li>
<li>运行完整的操作系统，还要安装运行软件</li>
</ol>
<blockquote>
<p>Docker :</p>
</blockquote>
<p>​ 相比之下 Docker 就显得格外的小巧。隔离，镜像（核心的环境 4m+jdk+mysql）需要的时候我们只需要去运行镜像就可以了，大大提升了灵活性</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d1b709bb810ce5c6b9f73b15be00aad3.png" alt="image-20211006143627502" class="img_ev3q"></p>
<p>Docker 技术 :</p>
<ol>
<li>运行在操作系统之上，容器没有内核，也不用虚拟硬件</li>
<li>每个容器是互相隔离的，又属于自己的文件系统，不会互相的影响</li>
</ol>
<p>了解了 Docker 的作用，可以知道我们程序员掌握 Docker 是十分的必要的</p>
<blockquote>
<p>社区文档</p>
</blockquote>
<p>Docker 的社区文档是十分的详细的</p>
<p>文档连接 : <a href="https://docs.docker.com/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/</a></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/49533587298023be1e905cab9b1d0f73.png" alt="image-20211006143117018" class="img_ev3q"></p>
<p>Docker 仓库地址 : <a href="https://www.docker.com/products/docker-hub" target="_blank" rel="noopener noreferrer">https://www.docker.com/products/docker-hub</a></p>
<blockquote>
<p>DevOps(开发和运维)</p>
</blockquote>
<p>他的宗旨是什么</p>
<p><strong>应用更快速的交付和部署</strong></p>
<ul>
<li>传统 : 一堆帮助文档，安装程序</li>
<li>Docker：打包镜像发布测试，一键运行</li>
</ul>
<p><strong>更便捷的升级和扩容</strong></p>
<p>使用了 Docker 之后，我们部署的应用和搭积木一样</p>
<p>项目打包成一个镜像，扩展到服务器 A，服务器 B</p>
<p><strong>更简单的系统运维</strong></p>
<p>在容器化之后，我们的开发，测试环境，高度的一致</p>
<p><strong>更高效的计算资源利用</strong></p>
<p>Docker 是内核级别的虚拟化，可以在一个物理机上运行很多的容器实例</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker-安装">Docker 安装<a href="#docker-安装" class="hash-link" aria-label="Direct link to Docker 安装" title="Direct link to Docker 安装">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-的组成结构">Docker 的组成结构<a href="#docker-的组成结构" class="hash-link" aria-label="Direct link to Docker 的组成结构" title="Direct link to Docker 的组成结构">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/571f7702a15987f6d10208f13b311b19.png" alt="查看源图像" class="img_ev3q"></p>
<p>镜像：</p>
<p>Docker 的镜像就像是一个模板，可以荣国这个模板来创建容器服务</p>
<p>例子：</p>
<p>tomcat ====》run ===》tomcat01 容器（提供服务）</p>
<p>我们可以同过镜像创建多个容器（最终服务运行或者是项目运行都是在容器中的）</p>
<p>容器：</p>
<p>Docker 利用容器技术，独立运行一个或者一组应用，通过容器来创建的</p>
<p>启动，停止，删除，等基本命令</p>
<p>目前我们可以把容器理解为一个建议的 linux 系统，项目都是跑在系统上的</p>
<p>仓库：</p>
<p>仓库就是存放镜像的地方</p>
<p>有私有的有共有的</p>
<p>DockerHub</p>
<p>阿里云等等厂商都有镜像服务</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="安装-docker">安装 Docker<a href="#安装-docker" class="hash-link" aria-label="Direct link to 安装 Docker" title="Direct link to 安装 Docker">​</a></h3>
<blockquote>
<p>环境准备</p>
</blockquote>
<ol>
<li>需要会一点点 linx 的基础</li>
<li>linux : CentOS7</li>
<li>使用连接工具连接服务器操作</li>
</ol>
<p>确认系统环境</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# uname -r</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">3.10.0-957.21.3.el7.x86_64</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# cat /etc/os-release</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">NAME=&quot;CentOS Linux&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">VERSION=&quot;7 (Core)&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ID=&quot;centos&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ID_LIKE=&quot;rhel fedora&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">VERSION_ID=&quot;7&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PRETTY_NAME=&quot;CentOS Linux 7 (Core)&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ANSI_COLOR=&quot;0;31&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CPE_NAME=&quot;cpe:/o:centos:centos:7&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">HOME_URL=&quot;https://www.centos.org/&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">BUG_REPORT_URL=&quot;https://bugs.centos.org/&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CENTOS_MANTISBT_PROJECT=&quot;CentOS-7&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CENTOS_MANTISBT_PROJECT_VERSION=&quot;7&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">REDHAT_SUPPORT_PRODUCT=&quot;centos&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">REDHAT_SUPPORT_PRODUCT_VERSION=&quot;7&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>官方文档可以看到要求：</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/9d957d75664c8a5ead0e3d7f2f201828.png" alt="image-20211006145800662" class="img_ev3q"></p>
<p>我们如果是用的 linxu 系统是 CentOS 那么必须是 7 版本以上才支持的</p>
<p>如果安装装过的话，建议删除之前的旧版本的 docker</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"> #1·卸载掉旧的版本</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> sudo yum remove docker \</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                  docker-client \</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                  docker-client-latest \</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                  docker-common \</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                  docker-latest \</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                  docker-latest-logrotate \</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                  docker-logrotate \</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                  docker-engine</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#2 需要的安装包</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> sudo yum install -y yum-utils</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#3设置镜像的仓库，默认是国外的（建议大家使用阿里云的镜像）</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">sudo yum-config-manager \</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    --add-repo \</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#4 安装docker相关的内容</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> yum install docker-ce docker-ce-cli containerd.io</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#5 安装之后测试是否安装成功</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">systemctl start docker</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#6查看docker的版本号</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker version</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>之后查看我们 docker 的版本即可</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/75439c23d98f9c80765ff7dc717c09aa.png" alt="image-20211006150606651" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#7 运行docker的helloword</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run hello-world</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/f8f4972a39d99e8f4dc445704a495987.png" alt="image-20211006150917425" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"># 8 如何查看docker下载的镜像呢？</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker images</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 就可以查看docker下载的位置了</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/93eae6f2e9d0ebc98cd89c3fa276ebd5.png" alt="image-20211006150957136" class="img_ev3q"></p>
<p>了解 如何卸载 docker</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#1 卸载docker的相关内容</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">yum remove docker-ce docker-ce-cli containerd.io</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#2 卸载docker的和我们下载容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> sudo rm -rf /var/lib/docker</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> sudo rm -rf /var/lib/containerd</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># /var/lib/docker 是 docker的默认工作路径</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>提升效率</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="阿里云的容器加速">阿里云的容器加速<a href="#阿里云的容器加速" class="hash-link" aria-label="Direct link to 阿里云的容器加速" title="Direct link to 阿里云的容器加速">​</a></h3>
<ol>
<li>
<p>登录阿里云找到容器服务</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/77252e88c60f276771458234b36f4f82.png" alt="image-20211006151353748" class="img_ev3q"></p>
</li>
<li>
<p>找到镜像加速地址</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/151bdf868b13587d449e5fc830a4d273.png" alt="image-20211006151407490" class="img_ev3q"></p>
</li>
<li>
<p>配置使用</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">sudo mkdir -p /etc/docker</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">sudo tee /etc/docker/daemon.json &lt;&lt;-&#x27;EOF&#x27;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">{</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  &quot;registry-mirrors&quot;: [&quot;https://v3ev0217.mirror.aliyuncs.com&quot;]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">}</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">EOF</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">sudo systemctl daemon-reload</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">sudo systemctl restart docker</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="回顾-hello-world-的完整过程">回顾 hello world 的完整过程<a href="#回顾-hello-world-的完整过程" class="hash-link" aria-label="Direct link to 回顾 hello world 的完整过程" title="Direct link to 回顾 hello world 的完整过程">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d4300db6dc027e73b1c83dd163438e6b.png" alt="image-20211006163940871" class="img_ev3q"></p>
<p>run 的过程分析图</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/f4897e329f360626c34585be8e4699a6.png" alt="image-20211006163925489" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="底层原理">底层原理<a href="#底层原理" class="hash-link" aria-label="Direct link to 底层原理" title="Direct link to 底层原理">​</a></h3>
<blockquote>
<p>docker 是做什么工作的？</p>
</blockquote>
<p>Docker 是一个 Client server 的系统，Docker 是守护进程运行在主机上。通过 socket 从客户端访问</p>
<p>DockerServer 接受到 Docker-Client 的指令，就会去执行这个命令。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/6f939530243320134b093b83c3192135.png" alt="image-20211006164315668" class="img_ev3q"></p>
<p>Docker 为什么比虚拟机快</p>
<ol>
<li>
<p>Docker 有着比虚拟机更少的抽象层</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/84388446a5243056933561567275738d.png" alt="image-20211006164353290" class="img_ev3q"></p>
</li>
<li>
<p>Docker 利用的是主机的内核，vm 需要的是 Guset OS</p>
</li>
<li>
<p>所以说新建一个容器的时候，docker 不需要想虚拟机一样重新加一个操作系统的内核，避免引导，</p>
</li>
<li>
<p>虚拟机是加载 Guest OS 分钟级别的，</p>
</li>
<li>
<p>而 docker 是利用主机的操作系统，省略了这个复杂的加载过程，秒级别</p>
</li>
</ol>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/27523c2da39108a3e1b10d65ad7dab04.png" alt="image-20211006164648744" class="img_ev3q"></p>
<p>现在的 docker 是都支持的</p>
<p>不只支持 linux，Mac OS, windows 都支持</p>
<p>之后又 docker 的使用经验之后我们回过头来再看理论，就会理解的很清晰了</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker-的常用命令">Docker 的常用命令<a href="#docker-的常用命令" class="hash-link" aria-label="Direct link to Docker 的常用命令" title="Direct link to Docker 的常用命令">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="帮助命令">帮助命令<a href="#帮助命令" class="hash-link" aria-label="Direct link to 帮助命令" title="Direct link to 帮助命令">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker version    #查看docker的版本信息</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker info       #显示docker的系统信息，包括容器和镜像的数量</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker --help     #显示docker的所有命令</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>帮助文档的地址 :</p>
<p><a href="https://docs.docker.com/engine/reference/run/" target="_blank" rel="noopener noreferrer">https://docs.docker.com/engine/reference/run/</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="镜像命令">镜像命令<a href="#镜像命令" class="hash-link" aria-label="Direct link to 镜像命令" title="Direct link to 镜像命令">​</a></h3>
<p><strong>Docker imeages #查看所有本地的主机上有的镜像</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker images</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">REPOSITORY    TAG       IMAGE ID       CREATED       SIZE</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">hello-world   latest    feb5d9fea6a5   12 days ago   13.3kB</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#解释</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">REPOSITORY 镜像的仓库源</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">TAG         镜像的标签</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">IMAGE ID    镜像的id</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CREATED     镜像的创建时间</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">SIZE        镜像的储存大小</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#可选项</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-a -all   #列出所有的镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-q --quiet  #只显示镜像的id</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Docker pull 下载</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#下载内容 ，默认的tag 是 latest</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#可以按照版本号 ，也可以直接用mysql下载版本</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker pull mysql:5.7</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">5.7: Pulling from library/mysql</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">07aded7c29c6: Already exists  #分段的下载，联合文件系统，不用重复下载，可以共用重复的部分</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">f68b8cbd22de: Already exists</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">30c1754a28c4: Already exists</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">1b7cb4d6fe05: Already exists</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">79a41dc56b9a: Already exists</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">00a75e3842fb: Already exists</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">b36a6919c217: Already exists</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">5e11fe494f45: Pull complete</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">9c7de1f889a7: Pull complete</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">cf6a13d05a76: Pull complete</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">fc5aa81f393a: Pull complete</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Digest: sha256:360c7488c2b5d112804a74cd272d1070d264eef4812d9a9cc6b8ed68c3546189</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Status: Downloaded newer image for mysql:5.7</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker.io/library/mysql:5.7</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/b45b41b9caa64608f98918a288731991.png" alt="image-20211006225936295" class="img_ev3q"></p>
<p><strong>删除命令</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker rmi -f 9f35042c6a98 #根据 镜像id 删除docker镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker rmi -f images id images id images id #批量删除docker镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker rmi -f $(docker images -aq) # 删除全部镜像</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/2eefae446dfdf18c2e6968e91eaca6bf.png" alt="image-20211006230329893" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="容器命令">容器命令<a href="#容器命令" class="hash-link" aria-label="Direct link to 容器命令" title="Direct link to 容器命令">​</a></h3>
<p>说明：我们有了镜像才可以创建容器，以 linux 为例子，创造一个 CentOS 的容器</p>
<p>来测试学习</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker pull centos</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>新建容器并且启动</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker run [可选参数] image</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#参数说明</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">--name = &quot;name&quot; 容器名字， tomcat 1 ，tomcat 2来区分容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-d              后台的方式运行</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-it             使用交互方式运行 ，进入容器查看内容</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-p              指定容器的端口 -p 8080：8080</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">	-p ip ：主机端口：容器端口</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">	-p  主机端口 ： 容器端口（常用）</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">	-p  容器端口</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-p               随机指定端口</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#测试，并且启动进入容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker run -it centos /bin/bash</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@aa1a02ed3f51 /]# ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">bin  etc   lib	  lost+found  mnt  proc  run   srv  tmp  var</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">dev  home  lib64  media       opt  root  sbin  sys  usr</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#推出容器查看</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ /]# ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">bin   dev  home  lib64       media  mynacos  nginxWebdata  patch  project  run   srv  tmp  var</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">boot  etc  lib   lost+found  mnt    myredis  opt           proc   root     sbin  sys  usr  www</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>列出所有运行的容器</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker ps</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#列出当前正在运行的容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-a  #列出当前正在运行的容器+带出历史运行过的内容</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-n = ？ #显示最近创建的容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-q    #只显示容器的编号</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#可以看到我们之前使用的 helloworld 和 centos 容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ /]#  docker ps -a</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CONTAINER ID   IMAGE          COMMAND       CREATED         STATUS                     PORTS     NAMES</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">aa1a02ed3f51   centos         &quot;/bin/bash&quot;   3 minutes ago   Exited (0) 2 minutes ago             upbeat_matsumoto</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">0341862ece26   feb5d9fea6a5   &quot;/hello&quot;      8 hours ago     Exited (0) 8 hours ago               clever_jennings</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>退出容器</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">exit #直接容器停止并且推出</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Ctrl + p + q #容器不停止 推出</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>删除容器</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker rm 容器id  # 删除指定容器，不能删除正在运行的容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker rm -f $(docker ps -aq) #删除所有的容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker ps -a|xargs docker rm #也可以删除所有的容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ /]# docker rm -f $(docker ps -aq)</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">aa1a02ed3f51</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">0341862ece26</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>启动和停止容器</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker start 容器id     #启动容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker restart 容器id   #重启容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker stop 容器id	  #关闭容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker kill 容器id	  #强制关闭当前的容器</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="常用的其他命令">常用的其他命令<a href="#常用的其他命令" class="hash-link" aria-label="Direct link to 常用的其他命令" title="Direct link to 常用的其他命令">​</a></h3>
<p><strong>后台启动容器</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#命令 docker run -d 镜像！</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#问题 docker ps 发现centos停止了</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#常见的坑 docker 容器使用后台运行，就必须要有一个前台的进程，docker发现没有前台的应用，就会自动停止</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#nginx 容器启动后，发现自己没有提供服务，就会立刻停止，就是没有程序了</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>查看日志</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker logs -f -t --tail 容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#自己编写一段shell脚本</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">while true; do echo hyc;sleep 1;done</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#查看运行是否成功</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ /]# docker ps -a</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS                     PORTS     NAMES</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">754a5ea93b0c   centos    &quot;/bin/sh -c &#x27;while t…&quot;   5 seconds ago   Exited (1) 5 seconds ago             sad_morse</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#显示日志</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker logs</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">显示全部日志</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker logs -tf cb8836c6fe21</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">按条件显示日志，之后一直显示</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker logs -tf --tail 10  cb8836c6fe2</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">--tf   #显示日志</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">--tail number #显示日志的条数</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看容器中的进程信息</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ /]# docker top cb8836c6fe21</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root                3490                3472                0                   23:32               ?                   00:00:00            /bin/sh -c while true;do echo hyc;sleep 1;done</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root                4994                3490                0                   23:39               ?                   00:00:00            /usr/bin/coreutils --coreutils-prog-shebang=sleep /usr/bin/sleep 1</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>查看镜像的元数据</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#命令 查看 docker inspect cb8836c6fe21</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Id&quot;: &quot;cb8836c6fe217ecab4ba2c0fa5f3d83ecd298c09f26aed3f2024062b0191bfcf&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Created&quot;: &quot;2021-10-06T15:32:31.74201481Z&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Path&quot;: &quot;/bin/sh&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Args&quot;: [</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;-c&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;while true;do echo hyc;sleep 1;done&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        ],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;State&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Status&quot;: &quot;running&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Running&quot;: true,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Paused&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Restarting&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;OOMKilled&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Dead&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Pid&quot;: 3490,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;ExitCode&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Error&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;StartedAt&quot;: &quot;2021-10-06T15:32:32.049192513Z&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Image&quot;: &quot;sha256:5d0da3dc976460b72c77d94c8a1ad043720b0416bfc16c52c45d4847e53fadb6&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/cb8836c6fe217ecab4ba2c0fa5f3d83ecd298c09f26aed3f2024062b0191bfcf/resolv.conf&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/cb8836c6fe217ecab4ba2c0fa5f3d83ecd298c09f26aed3f2024062b0191bfcf/hostname&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/cb8836c6fe217ecab4ba2c0fa5f3d83ecd298c09f26aed3f2024062b0191bfcf/hosts&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;LogPath&quot;: &quot;/var/lib/docker/containers/cb8836c6fe217ecab4ba2c0fa5f3d83ecd298c09f26aed3f2024062b0191bfcf/cb8836c6fe217ecab4ba2c0fa5f3d83ecd298c09f26aed3f2024062b0191bfcf-json.log&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Name&quot;: &quot;/wizardly_hopper&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;RestartCount&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Driver&quot;: &quot;overlay2&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Platform&quot;: &quot;linux&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;MountLabel&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;ProcessLabel&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;AppArmorProfile&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;ExecIDs&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;HostConfig&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Binds&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;ContainerIDFile&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;LogConfig&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;Type&quot;: &quot;json-file&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;Config&quot;: {}</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;NetworkMode&quot;: &quot;default&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;PortBindings&quot;: {},</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;RestartPolicy&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;Name&quot;: &quot;no&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;MaximumRetryCount&quot;: 0</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;AutoRemove&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;VolumeDriver&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;VolumesFrom&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CapAdd&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CapDrop&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CgroupnsMode&quot;: &quot;host&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Dns&quot;: [],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;DnsOptions&quot;: [],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;DnsSearch&quot;: [],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;ExtraHosts&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;GroupAdd&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;IpcMode&quot;: &quot;private&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Cgroup&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Links&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;OomScoreAdj&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;PidMode&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Privileged&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;PublishAllPorts&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;ReadonlyRootfs&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;SecurityOpt&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;UTSMode&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;UsernsMode&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;ShmSize&quot;: 67108864,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Runtime&quot;: &quot;runc&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;ConsoleSize&quot;: [</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                0</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Isolation&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CpuShares&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Memory&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;NanoCpus&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CgroupParent&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;BlkioWeight&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;BlkioWeightDevice&quot;: [],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;BlkioDeviceReadBps&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;BlkioDeviceWriteBps&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;BlkioDeviceReadIOps&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;BlkioDeviceWriteIOps&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CpuPeriod&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CpuQuota&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CpuRealtimePeriod&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CpuRealtimeRuntime&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CpusetCpus&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CpusetMems&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Devices&quot;: [],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;DeviceCgroupRules&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;DeviceRequests&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;KernelMemory&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;KernelMemoryTCP&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;MemoryReservation&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;MemorySwap&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;MemorySwappiness&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;OomKillDisable&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;PidsLimit&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Ulimits&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CpuCount&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;CpuPercent&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;IOMaximumIOps&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;IOMaximumBandwidth&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;MaskedPaths&quot;: [</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/asound&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/acpi&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/kcore&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/keys&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/latency_stats&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/timer_list&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/timer_stats&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/sched_debug&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/scsi&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/sys/firmware&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;ReadonlyPaths&quot;: [</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/bus&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/fs&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/irq&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/sys&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/proc/sysrq-trigger&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;GraphDriver&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Data&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/db5602f161d4930ca2f6f2d70eaddf29fb5daf635fa1307c9f3f9ee559ca7c50-init/diff:/var/lib/docker/overlay2/c57ecea0403cf58cf7c21ca1f4db2a1a84dadf594ceccd5560466191cfc22ec8/diff&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/db5602f161d4930ca2f6f2d70eaddf29fb5daf635fa1307c9f3f9ee559ca7c50/merged&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/db5602f161d4930ca2f6f2d70eaddf29fb5daf635fa1307c9f3f9ee559ca7c50/diff&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/db5602f161d4930ca2f6f2d70eaddf29fb5daf635fa1307c9f3f9ee559ca7c50/work&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Name&quot;: &quot;overlay2&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Mounts&quot;: [],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Config&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Hostname&quot;: &quot;cb8836c6fe21&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Domainname&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;User&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;AttachStdin&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;AttachStdout&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;AttachStderr&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Tty&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;OpenStdin&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;StdinOnce&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Env&quot;: [</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Cmd&quot;: [</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;/bin/sh&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;-c&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;while true;do echo hyc;sleep 1;done&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            ],</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Image&quot;: &quot;centos&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Volumes&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;WorkingDir&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Entrypoint&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;OnBuild&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Labels&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;org.label-schema.build-date&quot;: &quot;20210915&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;org.label-schema.license&quot;: &quot;GPLv2&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;org.label-schema.name&quot;: &quot;CentOS Base Image&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;org.label-schema.schema-version&quot;: &quot;1.0&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;org.label-schema.vendor&quot;: &quot;CentOS&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;NetworkSettings&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Bridge&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;SandboxID&quot;: &quot;7e30f1e5819c55f424a9444110159f16e04b63b5e5a4e53146eece8e4a8df0f3&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;HairpinMode&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;LinkLocalIPv6Address&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;LinkLocalIPv6PrefixLen&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Ports&quot;: {},</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/7e30f1e5819c&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;SecondaryIPAddresses&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;SecondaryIPv6Addresses&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;EndpointID&quot;: &quot;3e938d5faea175bc21e47cbc812e2157a9853ade29723ce12b6114c99637bb86&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Gateway&quot;: &quot;172.18.0.1&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;IPAddress&quot;: &quot;172.18.0.2&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;IPPrefixLen&quot;: 16,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;MacAddress&quot;: &quot;02:42:ac:12:00:02&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Networks&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;bridge&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;IPAMConfig&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;Links&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;Aliases&quot;: null,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;NetworkID&quot;: &quot;cedc24b7c89ecc2306b4f241d9a60b0a1b1246a8ce98c9013432c67af21785f6&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;EndpointID&quot;: &quot;3e938d5faea175bc21e47cbc812e2157a9853ade29723ce12b6114c99637bb86&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;Gateway&quot;: &quot;172.18.0.1&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;IPAddress&quot;: &quot;172.18.0.2&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;IPPrefixLen&quot;: 16,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;IPv6Gateway&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;GlobalIPv6Address&quot;: &quot;&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;GlobalIPv6PrefixLen&quot;: 0,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;MacAddress&quot;: &quot;02:42:ac:12:00:02&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;DriverOpts&quot;: null</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>进入容器之后，修改一些配置</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">我们容器通长使用后台的方式运行 需要进入容器 修改一些配置</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#命令</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ /]# docker ps -a #新建一个交互命令行</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">cb8836c6fe21   centos    &quot;/bin/sh -c &#x27;while t…&quot;   13 minutes ago   Up 13 minutes             wizardly_hopper</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ /]# docker exec -it cb8836c6fe21 /bin/bash</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@cb8836c6fe21 /]# ps -ef</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">UID        PID  PPID  C STIME TTY          TIME CMD</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root         1     0  0 15:32 ?        00:00:00 /bin/sh -c while true;do echo hyc;sleep 1;done</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root       986     0  0 15:48 pts/0    00:00:00 /bin/bash</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root      1014     1  0 15:48 ?        00:00:00 /usr/bin/coreutils --coreutils-prog-shebang=sleep /usr/bin</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root      1015   986  0 15:48 pts/0    00:00:00 ps -ef</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@cb8836c6fe21 /]#</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#方式二</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker attach 容器id</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#测试</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">进入之后会显示正在执行的 代码</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#docker exec 进入容器开启一个新的终端。可以再里面操作（常用）</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#docker attach 进入容器正砸执行的终端</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>从 docker 中取出文件</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#创建文件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ dockerTest]# touch athyc.java</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ dockerTest]# ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">athyc.java  hyc.java  test.java</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ dockerTest]# docker attach bcf5c1ea447c</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">You cannot attach to a stopped container, start it first</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ dockerTest]# docker ps -a</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CONTAINER ID   IMAGE     COMMAND       CREATED         STATUS                     PORTS     NAMES</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">bcf5c1ea447c   centos    &quot;/bin/bash&quot;   5 minutes ago   Exited (0) 4 minutes ago             cool_ishizaka</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">63184e5cad4d   centos    &quot;/bin/bash&quot;   8 minutes ago   Exited (0) 6 minutes ago             jovial_cori</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#启动容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ dockerTest]# docker start bcf5c1ea447c</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">bcf5c1ea447c</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ dockerTest]# docker start bcf5c1ea447c /bin/bash</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">bcf5c1ea447c</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Error response from daemon: No such container: bin/bash</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Error: failed to start containers: /bin/bash</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#进入命令行</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ dockerTest]# docker attach bcf5c1ea447c</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@bcf5c1ea447c /]# ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">bin  etc   lib	  lost+found  mnt  proc  run   srv  tmp  var</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">dev  home  lib64  media       opt  root  sbin  sys  usr</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@bcf5c1ea447c /]# cd /home</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#创建文件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@bcf5c1ea447c home]# touch someone.java</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@bcf5c1ea447c home]# ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">someone.java  test.java</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@bcf5c1ea447c home]# exit</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#从docker中复制文件到主机文件夹</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ dockerTest]# docker cp bcf5c1ea447c:/home/someone.java /dockerTest/</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ dockerTest]# ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">athyc.java  hyc.java  someone.java  test.java</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="小结">小结<a href="#小结" class="hash-link" aria-label="Direct link to 小结" title="Direct link to 小结">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/cfbcd30013a42355f809c1e330413230.png" alt="image-20211007001746033" class="img_ev3q"></p>
<p>日常使用命令大全</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">attach      Attach local standard input, output, and error streams to a running container</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  #当前shell下 attach连接指定运行的镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  build       Build an image from a Dockerfile # 通过Dockerfile定制镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  commit      Create a new image from a container&#x27;s changes #提交当前容器为新的镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  cp          Copy files/folders between a container and the local filesystem #拷贝文件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  create      Create a new container #创建一个新的容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  diff        Inspect changes to files or directories on a container&#x27;s filesystem #查看docker容器的变化</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  events      Get real time events from the server # 从服务获取容器实时时间</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  exec        Run a command in a running container # 在运行中的容器上运行命令</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  export      Export a container&#x27;s filesystem as a tar archive #导出容器文件系统作为一个tar归档文件[对应import]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  history     Show the history of an image # 展示一个镜像形成历史</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  images      List images #列出系统当前的镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  import      Import the contents from a tarball to create a filesystem image #从tar包中导入内容创建一个文件系统镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  info        Display system-wide information # 显示全系统信息</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  inspect     Return low-level information on Docker objects #查看容器详细信息</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  kill        Kill one or more running containers # kill指定docker容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  load        Load an image from a tar archive or STDIN #从一个tar包或标准输入中加载一个镜像[对应save]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  login       Log in to a Docker registry #</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  logout      Log out from a Docker registry</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  logs        Fetch the logs of a container</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  pause       Pause all processes within one or more containers</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  port        List port mappings or a specific mapping for the container</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  ps          List containers</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  pull        Pull an image or a repository from a registry</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  push        Push an image or a repository to a registry</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  rename      Rename a container</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  restart     Restart one or more containers</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  rm          Remove one or more containers</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  rmi         Remove one or more images</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  run         Run a command in a new container</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  save        Save one or more images to a tar archive (streamed to STDOUT by default)</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  search      Search the Docker Hub for images</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  start       Start one or more stopped containers</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  stats       Display a live stream of container(s) resource usage statistics</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  stop        Stop one or more running containers</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  top         Display the running processes of a container</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  unpause     Unpause all processes within one or more containers</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  update      Update configuration of one or more containers</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  version     Show the Docker version information</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  wait        Block until one or more containers stop, then print their exit codes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="练习">练习<a href="#练习" class="hash-link" aria-label="Direct link to 练习" title="Direct link to 练习">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="nginx">nginx<a href="#nginx" class="hash-link" aria-label="Direct link to nginx" title="Direct link to nginx">​</a></h3>
<blockquote>
<p>docker 安装 nginx</p>
</blockquote>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#1, 搜索镜像 search 建议去docker hub 上搜索可以看到详细信息</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker search nginx</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#2  拉取镜像 pull 下载镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker pull nginx</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#3  运行测试</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#使用参数</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#-d 后台运行</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># --name 给容器名字</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># -p 宿主机端口：容器端口</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker ps -a</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker run -d --name nginx01 -p 3344:80 nginx</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">30361d53c7276f50adecbef37a56865b9858a0b553efa7f33689c8c9f16d927e</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker ps</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                  NAMES</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">30361d53c727   nginx     &quot;/docker-entrypoint.…&quot;   30 seconds ago   Up 30 seconds   0.0.0.0:3344-&gt;80/tcp   nginx01</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# curl localhost:3344</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#测试通过，进入查看配置，之后停止容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# curl localhost:3344</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;!DOCTYPE html&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;html&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;head&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#成功</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;title&gt;Welcome to nginx!&lt;/title&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">html { color-scheme: light dark; }</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">body { width: 35em; margin: 0 auto;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">font-family: Tahoma, Verdana, Arial, sans-serif; }</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;/head&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;body&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;p&gt;If you see this page, the nginx web server is successfully installed and</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">working. Further configuration is required.&lt;/p&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;p&gt;For online documentation and support please refer to</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;a href=&quot;http://nginx.org/&quot;&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Commercial support is available at</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;a href=&quot;http://nginx.com/&quot;&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;p&gt;&lt;em&gt;Thank you for using nginx.&lt;/em&gt;&lt;/p&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;/body&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">&lt;/html&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker exec -it nginx01 /bin/bash</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root@30361d53c727:/# ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">bin  boot  dev	docker-entrypoint.d  docker-entrypoint.sh  etc	home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root@30361d53c727:/# whereis nginx</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">nginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root@30361d53c727:/# cd /etc/nginx</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root@30361d53c727:/etc/nginx# ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">conf.d	fastcgi_params	mime.types  modules  nginx.conf  scgi_params  uwsgi_params</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root@30361d53c727:/etc/nginx# exit</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">exit</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">install.sh</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker ps</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS                  NAMES</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">30361d53c727   nginx     &quot;/docker-entrypoint.…&quot;   7 minutes ago   Up 7 minutes   0.0.0.0:3344-&gt;80/tcp   nginx01</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker stop 30361d53c727</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">30361d53c727</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>端口暴露的概念</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/7fcadb319b80f6ef3351e499700593a4.png" alt="image-20211007113424795" class="img_ev3q"></p>
<p>思考：是不是我们每次创建一个 nginx 容器部署点东西，都需要去修改配置，这显然很耗时间，那么我们 需要怎么做呢， -v 数据卷容器，可以解决，</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tomcat">tomcat<a href="#tomcat" class="hash-link" aria-label="Direct link to tomcat" title="Direct link to tomcat">​</a></h3>
<blockquote>
<p>docker 安装 tomcat</p>
</blockquote>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#官方的实例 用完就会删除，</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -it --rm tomcat:9.0</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#我们之前启动的都是后台，停止了容器之后，后台还是可以查到，docker run -it --rm一般用来测试，用完就会自动删除</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#下载启动</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker pull tomcat:9.0</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#启动运行</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -p 3355:8080 --name tomcat01 tomcat</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#发现可以访问但是没有内容，这是为什么呢，应为下载的tomcat是阉割版本，webapps下是空的所有没有</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root@3fba46045c12:/usr/local/tomcat# ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">BUILDING.txt	 LICENSE  README.md	 RUNNING.txt  conf  logs	    temp     webapps.dist</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CONTRIBUTING.md  NOTICE   RELEASE-NOTES  bin	      lib   native-jni-lib  webapps  work</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root@3fba46045c12:/usr/local/tomcat# cd webapps</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">root@3fba46045c12:/usr/local/tomcat/webapps#</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#问题 linux命令少了，webapps是空的，为什么？ 应为阿里云的镜像是最小的，把不必要的都剔除掉了，保证最小的运行</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#webapps.dist 我们之前webapps的东西都在这个dist里面，只需要复制内容到webapps中就可以完成访问了</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/5ec39e27bc9628ca1ae5264d89bf05ef.png" alt="image-20211007133450899" class="img_ev3q"></p>
<p>思考：每次开一个 tomcat 的容器，就得去复制一次 dist 文件，要是我部署了项目岂不是每次都会消失，没有持久化，那还得了。这个还只是 tomcat。要是 mysql 容器删除了，那岂不是直接数据全部丢失。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="可视化">可视化<a href="#可视化" class="hash-link" aria-label="Direct link to 可视化" title="Direct link to 可视化">​</a></h3>
<ul>
<li>
<p>portainer（先使用这个）</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -p 8088:9000\</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">--restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Rancher（CI/CD 再用）</p>
</li>
</ul>
<p>什么是 portainer</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -p 8088:9000\</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">--restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>之后就可以通过它访问了</p>
<p><a href="http://120.79.14.203:8088/#/init/admin" target="_blank" rel="noopener noreferrer">http://120.79.14.203:8088/#/init/admin</a></p>
<p>进入之后会要先注册一个账号</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/91b73b2ae9296a70e358d53a546a0534.png" alt="image-20211007151140339" class="img_ev3q"></p>
<p>之后选择本地的</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/951ba7a4dc80fbb073d91dc5317b51a6.png" alt="image-20211007151211509" class="img_ev3q"></p>
<p>之后就可以看到 docker 的内容了</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/ac6b7107ca9a799cb620fb4bf4bce665.png" alt="image-20211007151405290" class="img_ev3q"></p>
<p>比如有多少镜像阿，多少容器阿，可以点进去操作命令</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker-镜像讲解">Docker 镜像讲解<a href="#docker-镜像讲解" class="hash-link" aria-label="Direct link to Docker 镜像讲解" title="Direct link to Docker 镜像讲解">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="镜像是什么">镜像是什么<a href="#镜像是什么" class="hash-link" aria-label="Direct link to 镜像是什么" title="Direct link to 镜像是什么">​</a></h3>
<p>镜像是一种轻量级可执行的独立软件包，用来打包软件运行环境和基于环境发开的软件，它包含运行某个软件所需要的内容，包括代码，运行时，库，环境变量，配置文件。</p>
<p>所有的应用，直接打包 docker 镜像，就可以直接跑起来</p>
<p>如何获得镜像：</p>
<ul>
<li>从远程仓库下载</li>
<li>朋友拷贝</li>
<li>自己制作镜像 dockerfile</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="docker-镜像加载原理">Docker 镜像加载原理<a href="#docker-镜像加载原理" class="hash-link" aria-label="Direct link to Docker 镜像加载原理" title="Direct link to Docker 镜像加载原理">​</a></h3>
<blockquote>
<p>UnionFS 联合文件系统</p>
</blockquote>
<p><strong><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/a215659899b896e2d33d290cb07a4be7.png" alt="image-20211007152543164" class="img_ev3q"></strong></p>
<blockquote>
<p>Docker 镜像加载的原理</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/2791350f4d39849629444a20901ced6e.png" alt="image-20211007152852449" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="分层理解">分层理解<a href="#分层理解" class="hash-link" aria-label="Direct link to 分层理解" title="Direct link to 分层理解">​</a></h3>
<blockquote>
<p>分层的镜像</p>
</blockquote>
<p>我们可以去下载一个镜像，注意观察下载的日志输出，可以看到一层层的下载，</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/dcd5a6c3eb8cb9236d925bf954094039.png" alt="image-20211007153412138" class="img_ev3q"></p>
<p>我们会发只会下载一些新的，之前老的都是可以复用的</p>
<blockquote>
<p>Docker 的分层</p>
</blockquote>
<p>每个操作系统都有自己的储存方式</p>
<p>docker 上我们的操作可以是再镜像层面的基础上新加了一层，</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/bd02e647ec8e0010490fdcc29db45ffc.png" alt="image-20211007154232293" class="img_ev3q"></p>
<blockquote>
<p>docker 镜像的特点</p>
</blockquote>
<p>docker 的镜像一般都是只读状态的，我们 run 起来的容器，都是再容器层面，新写的层面会被加到顶部。</p>
<p>所以我们的所有操作都是基于容器的，容器基于一个基本的镜像，</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/47dcd822c86749b47ef5a2b1248cebb5.png" alt="image-20211007154640895" class="img_ev3q"></p>
<p>理解了这些我们再去提交一个属于自己的镜像</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="commit-镜像">COMMIT 镜像<a href="#commit-镜像" class="hash-link" aria-label="Direct link to COMMIT 镜像" title="Direct link to COMMIT 镜像">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker commit 提交哦让其成为一个新的副本</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#命令和git的原理类似</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker commit -m = “提交的描述i星系” -a =“作者” 容器id 目标的镜像名字：【tag】</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>实战测试：打包一个 webapps 下有文件的 tocmat 上去</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#1 启动一个tomcat</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#2 之前发现的问题，我们的tomcat下默认是没有文件的，都放在 webapps.dist虚下，每次我们都需要去将这个文件夹中的东西去复制到webapps中，十分的麻烦。</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#3我自己将文件拷贝到了基本文件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#4 我自己拷贝的镜像我提交了。这个比较好用，我直接提交上去用我提交的我觉得舒服的镜像</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>到了这里就算是入门 Docker</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="容器数据卷">容器数据卷<a href="#容器数据卷" class="hash-link" aria-label="Direct link to 容器数据卷" title="Direct link to 容器数据卷">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="什么是容器的数据卷">什么是容器的数据卷<a href="#什么是容器的数据卷" class="hash-link" aria-label="Direct link to 什么是容器的数据卷" title="Direct link to 什么是容器的数据卷">​</a></h3>
<p><strong>docker 的理念回顾</strong></p>
<p>将应用环境打包成一个镜像！</p>
<p>数据 如果数据在容器中，我们容器删除的话，数据也会跟着消失 ==需求 :需要持久化==</p>
<p>MySql 容器删除＝删库跑路 ==需求：MySql 数据可以存储到本地！==</p>
<p>容器之间可以有一个数据空想的技术，docker 容器中产生的数据，同步到本地</p>
<p>删除容器数据不会消失，这个就是卷技术</p>
<p>目录的挂载，将我们的容器内的目录，挂在到 linux 上！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/ed137902480988ab71a8ca38e95a719b.png" alt="image-20211007162143064" class="img_ev3q"></p>
<p><strong>容器需要持久化和同步操作，容器间也可以数据共享</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用数据卷">使用数据卷<a href="#使用数据卷" class="hash-link" aria-label="Direct link to 使用数据卷" title="Direct link to 使用数据卷">​</a></h3>
<blockquote>
<p>方式 1：直接使用命令来挂在 -v</p>
</blockquote>
<div class="language-SHELL language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -it -v  主机目录:容器目录</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#挂载测试</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -it -v /dockerTest/ceshi/:/home centos /bin/bash</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#查看容器元数据</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker inspcet 容器id</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/c0c576034f4e436abfcf0b36a6d54cb9.png" alt="image-20211007162919462" class="img_ev3q"></p>
<p>可以看到卷的挂载信息</p>
<p>绑定信息确认之后，我们来试试是不是真的成功了</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/a2ced49787afe11f3b37f0438cf9cedb.png" alt="image-20211007163222265" class="img_ev3q"></p>
<p>绑定成功，之后我们测试，就是是不是容器停止下来数据还能有数据嘛？</p>
<p>我们这里在服务器的 testjava 文件中写点内容</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d8e5acaf2f84512e79afe285856e8e4e.png" alt="image-20211007163529383" class="img_ev3q"></p>
<p>之后去启动容器看看是否 同步</p>
<p>同步成功！！！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/a67b1aae6dc3d6c6a4bfcc322d374292.png" alt="image-20211007163639956" class="img_ev3q"></p>
<p>到这里我们就实现了数据卷的数据持久化操作，只要容器不消失，关闭之后再次打开也是可以看更改的内容的。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实战安装-mysql">实战安装 mysql<a href="#实战安装-mysql" class="hash-link" aria-label="Direct link to 实战安装 mysql" title="Direct link to 实战安装 mysql">​</a></h3>
<p>mysql 持久话的问题</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#拉去mysql的镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker pull mysql:5.7</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#启动挂载mysql的容器 mysql是必须要有密码的</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#官方的测试</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> # -e 我们这里可以看到，我们需要配置环境的时候，就可以用-e来配置</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -p 3310:3306</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-v /dockerTest/mysql/conf:/etc/mysql/conf.d</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-v /dockerTest/mysql/data:/var/lib/mysql</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#-d 是后台挂在</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#-p 映射端口</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#-v 卷挂载</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#--name 容器名字</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#--e 配置环境，mysql密码</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#启动成功之后打开数据库连接工具连接docker的mysql</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#navicat 连接 服务器的3310（映射的docker 3306）连接成功</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#测试本地创建数据库，查看是否data的内容映射到成功</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>哪怕我们将容器删除，我们挂载到本地的数据是不会丢失的，这就实现了容器持久化。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="具名挂载和匿名挂载">具名挂载和匿名挂载<a href="#具名挂载和匿名挂载" class="hash-link" aria-label="Direct link to 具名挂载和匿名挂载" title="Direct link to 具名挂载和匿名挂载">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#匿名挂载</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-v 容器内路径</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -P --name nginx01 -v /etc/nginx nginx</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#查看卷（volume）的信息</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker volume ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#这里发现数据都是没有名字的，这里我们没有设置本机的路径，-v只写了容器内的路径，这个就是匿名挂载</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#具名挂载</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -P -v juming-nginx:/etc/nginx nginx</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">查看卷信息</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker volume ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">local     10f1524cc8295a9e7dfd75c88dab113395da11959756738bf121b5733ac2be70</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">local     24439de8b83f5493f971314bc3e5ca0e8f60d14a338ee19c7e35910403ade730</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">local     juming-nginx</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">可以看到我们刚才的设置的</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#通过 -v 卷名 ： 容器内路径</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#查看一下这个卷</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/126f6f892af183083502428ab7ca4c80.png" alt="image-20211008161005185" class="img_ev3q"></p>
<p>所有的 docker 容器内的卷，，没有指定目录，就都会放在<code>/var/lic/docker/volumes/xxx/_data</code></p>
<p>我们通过具名挂载可以很轻松拿出来配置。大多数的时候我们都是<code>具名挂载</code></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/2ef7f1e70ccdc0f79de4ce1e73baa972.png" alt="image-20211008161214811" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#如何区分具名挂载，匿名挂载，和绝对路径挂载</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-v 容器内路径  #匿名挂载</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-v 卷名 ：容器内路径 #具名挂载</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-v /宿主机路径：容器路径 #指定路径挂载</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>拓展</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#通过 -v 容器内的路径ro ow改变读写权限</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ro readonly #只读</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">rw redwrite #可读可写</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#一旦设置了容器权限，容器对我们挂载出来的内容就有限顶了</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#ro 只要看到ro就说明这个路径只能通过宿主机来操作，容器内部是无法操作的</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="初识-dockerfile">初识 dockerfile<a href="#初识-dockerfile" class="hash-link" aria-label="Direct link to 初识 dockerfile" title="Direct link to 初识 dockerfile">​</a></h3>
<p>dockerfile 就是通过构建 docker 镜像的构建文件，命令脚本，</p>
<p>通过脚本可以生成镜像，镜像是一层一层的，脚本就是一个个命令，每个命令就是一层</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">#创建一个dockerfile 的文件，名字可以随意，建议dockerfile</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#文件中的内容 大写</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">FROM centos</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">VOLUME [&quot;volume01&quot;,&quot;volume02&quot;]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CMD	echo &quot;------end-------&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CMD /bin/bash</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#这里的每个指令就是镜像的一层</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/95a538f534f4f41833409d13f31ca947.png" alt="image-20211008170701378" class="img_ev3q"></p>
<p>启动 i 自己的容器</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/90059d79e212343bb883893ce6463d08.png" alt="image-20211008171210378" class="img_ev3q"></p>
<p>这个卷和外部一定有一个同步的目录</p>
<p>这个是匿名挂载</p>
<p>我们要找的话一定是一段很长的乱码</p>
<p>找到卷挂载的命令</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d1842e8ae843dd3d338ef12ade9d1960.png" alt="image-20211008171418747" class="img_ev3q"></p>
<p>容器同步成功</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/8f821faa0c9143f5278e0bb11e3dda6a.png" alt="image-20211008171600981" class="img_ev3q"></p>
<p>这种方式我们未来使用的十分多，因为我们通常会构建自己的镜像</p>
<p>假设构建的时候没有挂载卷，要手动镜像挂载，-v 卷名：容器路径！</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="数据卷容器">数据卷容器<a href="#数据卷容器" class="hash-link" aria-label="Direct link to 数据卷容器" title="Direct link to 数据卷容器">​</a></h3>
<p>容器之间同步数据</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/1acfb718259fa8a4b12bdc6185507c23.png" alt="image-20211008171856431" class="img_ev3q"></p>
<p>我们要打开三个容器，启动第一个：可以看到我们挂载的两个容器</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/1e7ee4ca8beacf47c88319d46e428251.png" alt="image-20211008172215072" class="img_ev3q"></p>
<p>这里我们跑起来容器</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -it --name docker02 --volumes-from docker01 2dd933a342b1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>挂载我们的 docker01</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/40d957bc19a16aac440613a07e752616.png" alt="image-20211008173147275" class="img_ev3q"></p>
<p>我们可以看到 docker02 的里面也有之前两个挂载的容器</p>
<p>我们在 docker01 新增 volume01 新建个文件夹 docker01，在 docker02 中也可以看见</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/7e3dc32163d905f2a62c8e36eba82b8d.png" alt="image-20211008173242330" class="img_ev3q"></p>
<p>这里是 docker02 查看 volume1 的内容</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/71602b495cf4460b8e8e9f722ead2751.png" alt="image-20211008173235639" class="img_ev3q"></p>
<p>可以看出已经很明显了，挂载成功，这个时候我们 docker01 就是数据卷容器同时也是 docker01 容器</p>
<p>只要还有容器在挂载数据就不会丢失</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/68790ccec8fda3fb4785346baa3db906.png" alt="image-20211008173533997" class="img_ev3q"></p>
<p>多个 mysql 实现数据共享</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -p 3310:3306</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-v /etc/mysql/conf.d</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-v /var/lib/mysql</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:5.7</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#mysql02挂载mysql01</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -p 3310:3306</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-e MYSQL_ROOT_PASSWORD=123456 --name mysql01 --volumes-from mysql01  mysql:5.7</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="结论">结论：<a href="#结论" class="hash-link" aria-label="Direct link to 结论：" title="Direct link to 结论：">​</a></h3>
<p>容器之间配置信息，数据卷容器的生命周期一直持续到没有容器位置</p>
<p>但是一旦持久化到了本地， 就不会消失</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dockerfile">dockerfile<a href="#dockerfile" class="hash-link" aria-label="Direct link to dockerfile" title="Direct link to dockerfile">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dockerfile-介绍">dockerfile 介绍<a href="#dockerfile-介绍" class="hash-link" aria-label="Direct link to dockerfile 介绍" title="Direct link to dockerfile 介绍">​</a></h3>
<p>用来构建 docker 镜像的</p>
<p>构建步骤：</p>
<ul>
<li>编写一个 docker file 文件</li>
<li>docker build 构建成一个镜像</li>
<li>docker run 运行镜像</li>
<li>docker push 发布镜像（Docker hub 阿里云镜像）</li>
</ul>
<p>我们来看看官方是怎么做的</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/5fe1239c19b3466b602364bff68bd209.png" alt="image-20211106170721576" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/a45bf838b0c472bd68b5584b67daef7e.png" alt="image-20211106172154705" class="img_ev3q"></p>
<p>很多官方的镜像都是基础包，很多功能没有，我们通常会自己搭建自己的镜像</p>
<p>官方可以制作镜像，那我们也可以</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dockerfile-构建过程">DockerFile 构建过程<a href="#dockerfile-构建过程" class="hash-link" aria-label="Direct link to DockerFile 构建过程" title="Direct link to DockerFile 构建过程">​</a></h3>
<p><strong>基础知识</strong>：</p>
<ul>
<li>每个保留关键字，指令都必须是大写字母</li>
<li>执行从上到下执行</li>
<li>#表示注释</li>
<li>每个指令都会创建提交一个新的镜像层</li>
</ul>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/525155f42add449636280bedd39d4080.png" alt="image-20211106172456651" class="img_ev3q"></p>
<p>dockerfile 是面向开发的，我 i 们以后需要发布项目，做镜像，就需要编写 dockerfile 文件，这个文件十分简单。</p>
<p>我们要掌握 dockerfile 就基本可以掌握常用的 docker 镜像企业交付了</p>
<p>dockerfile ：构建文件，定义了一切步骤，源代码</p>
<p>dockerimages：通过 dockerfile 生成的镜像，最终发布和运行的产品</p>
<p>docker 容器：容器就是镜像运行起来，提供服务的</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="dockerfile-的指令">Dockerfile 的指令<a href="#dockerfile-的指令" class="hash-link" aria-label="Direct link to Dockerfile 的指令" title="Direct link to Dockerfile 的指令">​</a></h3>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">FROM            # 基础镜像，一切从这里开始构建</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">MAINTAINER      # 镜像是谁写的， 姓名+邮箱</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">RUN             # 镜像构建的时候需要运行的命令</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ADD             # 步骤， tomcat镜像， 这个tomcat压缩包！添加内容</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">WORKDIR         # 镜像的工作目录</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">VOLUME          # 挂载的目录</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">EXPOSE          # 保留端口配置</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CMD             # 指定这个容器启动的时候要运行的命令，只有最后一个会生效可被替代</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENTRYPOINT      # 指定这个容器启动的时候要运行的命令， 可以追加命令</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ONBUILD         # 当构建一个被继承DockerFile 这个时候就会运行 ONBUILD 的指令，触发指令</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">COPY            # 类似ADD, 将我们文件拷贝到镜像中</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENV             # 构建的时候设置环境变量！</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/807fd8aa351dd687851902d9290046da.png" alt="image-20211106172810755" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实战测试">实战测试<a href="#实战测试" class="hash-link" aria-label="Direct link to 实战测试" title="Direct link to 实战测试">​</a></h3>
<blockquote>
<p>创建一个自己的 centos</p>
</blockquote>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">FROM centos</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">MAINTAINER hyc&lt;3132774018@qq,com&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENV MYPATH /usr/local</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">WORKDIR $MYPATH</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">RUN yum -y install vim</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">RUN yum -y install net-tools</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">EXPOSE 80</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CMD echo $MYPATH</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CMD echo &quot;---end---&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CMD /bin/bash</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 2. 通过这个文件构建镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 命令 docker build -f dockerfile文件路径 -t 镜像名:[tag] .</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ dockerfile]# docker build -f mydockerfile-centos -t mycentos:0.1 .</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Successfully built d2d9f0ea8cb2</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Successfully tagged mycentos:0.1</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#测试运行</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>对比之前原生的 centos</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/7be8c55dc144f7b94e506fcb02f040e4.png" alt="image-20211106180200362" class="img_ev3q"></p>
<p>我们增加了 vim 和 net-tools</p>
<p>我们可以查看一下镜像的变更历史</p>
<p><code>docker history &lt;imagesid&gt;</code></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/f546c42e1e4ce529b69b0db69044710c.png" alt="image-20211106180537787" class="img_ev3q"></p>
<p>我们平时拿到一个镜像可以研究他是怎么构建的</p>
<blockquote>
<p>CMD 和 ENTRYPOINT 区别</p>
</blockquote>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">CMD         # 指定这个容器启动的时候要运行的命令，只有最后一个会生效可被替代</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENTRYPOINT      # 指定这个容器启动的时候要运行的命令， 可以追加命令</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="测试-cmd">测试 CMD<a href="#测试-cmd" class="hash-link" aria-label="Direct link to 测试 CMD" title="Direct link to 测试 CMD">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"># 1. 编写dockerfile文件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ dockerfile]# vim dockerfile-cmd-test</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">FROM centos</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CMD [&quot;ls&quot;, &quot;-a&quot;]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 2. 构建镜像</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ dockerfile]# docker build -f dockerfile-cmd-test -t cmdtest .</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 3. run运行， 发现我们的ls -a 命令生效</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ dockerfile]# docker run ebe6a52bb125</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">.</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">..</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">.dockerenv</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">bin</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">dev</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">etc</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">home</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">lib</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">lib64</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 想追加一个命令 -l 变成 ls -al</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ dockerfile]# docker run ebe6a52bb125 -l</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker: Error response from daemon: OCI runtime create failed: container_linux.go:349: starting container process caused &quot;exec: \&quot;-l\&quot;: executable file not found in $PATH&quot;: unknown.</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ dockerfile]# docker run ebe6a52bb125 ls -l</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># cmd的情况下 -l替换了CMD[&quot;ls&quot;, &quot;-a&quot;]命令， -l不是命令，所以报错了</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="测试-entrypoint">测试 ENTRYPOINT<a href="#测试-entrypoint" class="hash-link" aria-label="Direct link to 测试 ENTRYPOINT" title="Direct link to 测试 ENTRYPOINT">​</a></h4>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"># 1. 编写dockerfile文件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ dockerfile]# vim dockerfile-entrypoint-test</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">FROM centos</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENTRYPOINT [&quot;ls&quot;, &quot;-a&quot;]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 2. 构建文件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ dockerfile]# docker build -f dockerfile-entrypoint-test -t entrypoint-test .</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 3. run运行 发现我们的ls -a 命令同样生效</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ dockerfile]# docker run entrypoint-test</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">.</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">..</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">.dockerenv</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">bin</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">dev</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">etc</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">home</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">lib</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 4. 我们的追加命令， 是直接拼接到ENTRYPOINT命令的后面的！</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ dockerfile]# docker run entrypoint-test -l</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">total 56</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">drwxr-xr-x  1 root root 4096 Aug 13 07:52 .</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">drwxr-xr-x  1 root root 4096 Aug 13 07:52 ..</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">-rwxr-xr-x  1 root root    0 Aug 13 07:52 .dockerenv</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">lrwxrwxrwx  1 root root    7 May 11  2019 bin -&gt; usr/bin</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">drwxr-xr-x  5 root root  340 Aug 13 07:52 dev</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">drwxr-xr-x  1 root root 4096 Aug 13 07:52 etc</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">drwxr-xr-x  2 root root 4096 May 11  2019 home</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">lrwxrwxrwx  1 root root    7 May 11  2019 lib -&gt; usr/lib</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">lrwxrwxrwx  1 root root    9 May 11  2019 lib64 -&gt; usr/lib64</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">drwx------  2 root root 4096 Aug  9 21:40 lost+found</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实战-tomcat">实战 tomcat<a href="#实战-tomcat" class="hash-link" aria-label="Direct link to 实战 tomcat" title="Direct link to 实战 tomcat">​</a></h3>
<p>这里我们先准备好 需要用到的 安装包</p>
<ul>
<li>apache-tomcat-9.0.54.tar.gz</li>
<li>jdk-8u311-linux-x64.tar.gz</li>
</ul>
<ol>
<li>
<p>准备镜像文件 tomcat 压缩包，jdk 的压缩包！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/20200813164403261.png" alt="在这里插入图片描述" class="img_ev3q"></p>
</li>
<li>
<p>编写 Dockerfile 文件，官方命名<code>Dockerfile</code>, build 会自动寻找这个文件，就不需要-f 指定了！</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ dockerfiletomcat]# cat Dockerfile</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">FROM centos</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">MAINTAINER hyc&lt;3132774018@qq.com&gt;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">COPY readme.txt /usr/local/readme.txt</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ADD jdk-8u311-linux-x64.tar.gz /usr/local/</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ADD apache-tomcat-9.0.54.tar.gz /usr/local/</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">RUN yum -y install vim</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENV MYPATH /usr/local</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">WORKDIR $MYPATH</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENV JAVA_HOME /usr/local/jdk1.8.0_311</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.54</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENV CATALINA_BASH /usr/local/apache-tomcat-9.0.54</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">EXPOSE 8080</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CMD /usr/local/apache-tomcat-9.0.54/bin/startup.sh &amp;&amp; tail -F /usr/local/apache-tomcat-9.0.54/bin/logs/catalina.out</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>启动并且挂载</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -p 3344:8080 --name hyctomcat11 -v /dockerTest/dockerfiletomcat/test:/usr/local/apache-tomcat-9.0.54/webapps/test -v /dockerTest/dockerfiletomcat/tomcatlogs/:/usr/local/apache-tomcat-9.0.54/logs diytomcat</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>访问 3344 端口</p>
</li>
</ol>
<p>成功</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/f4e089461983627233396d16a8450bdf.png" alt="image-20211106212344365" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="发布">发布<a href="#发布" class="hash-link" aria-label="Direct link to 发布" title="Direct link to 发布">​</a></h3>
<p>注册 docker hub 账号</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/1b4962487b98354993149580e123e987.png" alt="image-20211107171256066" class="img_ev3q"></p>
<p>到服务器命令行登陆</p>
<div class="language-SHELL language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker login -u doomwatcher</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Password:</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">WARNING! Your password will be stored unencrypted in /root/.docker/config.json.</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Configure a credential helper to remove this warning. See</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">https://docs.docker.com/engine/reference/commandline/login/#credentials-store</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">Login Succeeded</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>登陆自己的 docker 账户</p>
<p>登录成我们就可以 push 到 自己的仓库了</p>
<p>之后我们要给之前我们自己写的 tocmat 规范命名 <code> docker tag dockerhub用户名/镜像名：版本号</code></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZwz90ps06ioyada63oiwiZ ~]# docker tag diytomcat  doomwatcher/diytomcat:1.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/07b9bacd1f30d79974ae66aac57a9691.png" alt="image-20211107172125161" class="img_ev3q"></p>
<p>之后我们用 docker push 到我们的 docker 上</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/ec9fae64e9fd35a5dcded73fe0a70a93.png" alt="image-20211107172219696" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/e00d1f00dec9c5b47bcdc4487cea1bb4.png" alt="image-20211107172248100" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker-网络">docker 网络<a href="#docker-网络" class="hash-link" aria-label="Direct link to docker 网络" title="Direct link to docker 网络">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="认识-docker-网络">认识 docker 网络<a href="#认识-docker-网络" class="hash-link" aria-label="Direct link to 认识 docker 网络" title="Direct link to 认识 docker 网络">​</a></h3>
<blockquote>
<p>测试 ip addr 查看</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/130ece6844f2e1d2489edf6d774e8889.png" alt="image-20211107193400215" class="img_ev3q"></p>
<p>我们可以测试一下，容器和容器之间 能不能 ping 通</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/3fbd18792c9b59a05cd61493f6a6c2af.png" alt="image-20211107193505174" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"># 跑一个tomcat</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -P --name tomcat01 tomcat</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 获取ip</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ip addr</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 我们可以用查看元数据的方式查看 容器的ip地址</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/1108394344d31f0c571bf239d365d792.png" alt="image-20211107194843093" class="img_ev3q"></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"># 之后用宿主机 linux 去ping容器</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> ping 172.18.0.2</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> # 能通</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/e3e9c1073f8c924de56dff50560ec772.png" alt="image-20211107194927467" class="img_ev3q"></p>
<blockquote>
<p>原理</p>
</blockquote>
<ol>
<li>我们每启动一个 docker 容器， docker 就会给 我们的每一个容器分配一个 ip</li>
<li>我们只要安装 docker 就会有一个网卡 docker0 桥接模式，使用的技术是 evth-pair 技术</li>
</ol>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d3898de85d3600d70cc10ccb829568bb.png" alt="image-20211107195156421" class="img_ev3q"></p>
<p>我们新启动的容器就会多一个新的网卡</p>
<p>我们发现，这些容器的网卡都是一对一对的</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"># 我们发现这个容器带来网卡，都是一对对的</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># veth-pair 就是一对的虚拟设备接口，他们都是成对出现的，一端连着协议，一端彼此相连</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 正因为有这个特性，veth-pair充当一个桥梁， 连接各种虚拟网络设备</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># OpenStac， Docker容器之间的链接，OVS的链接， 都是使用veth-pair技术</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/550ec4b45731d99f5894945965679813.png" alt="image-20211107195532158" class="img_ev3q"></p>
<p>我们新建一个 tomcat 尝试容器之间是否能够 ping 通</p>
<p>结论：容器与容器之间是可以相互 ping 通的！</p>
<p>绘制一个网络模型图</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/pic01.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<p>结论：tomcat01 和 tomcat02 是共用的一个路由器，docker0</p>
<p>所有容器不指定网络的情况下，都是 docker0 路由的，doucker 会给我们的容器分配一个默认的可用 IP</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="小结-1">小结<a href="#小结-1" class="hash-link" aria-label="Direct link to 小结" title="Direct link to 小结">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/pic02.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<p>Docker 使用的是 Linux 的桥接，宿主机中是一个 Docker 容器的网桥 docker0.</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/pic03.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<p>Docker 中的所有的网络接口都是虚拟的，虚拟的转发效率高！（内网传递文件！）</p>
<p>只要容器删除，对应的网桥一对就没有了！</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="--link">--link<a href="#--link" class="hash-link" aria-label="Direct link to --link" title="Direct link to --link">​</a></h3>
<blockquote>
<p>思考一个场景，我们编写了一个微服务，database url =ip； 项目不重启，数据 ip 换掉了，我们希望可以处理这个问题，可以按名字来进行访问容器</p>
</blockquote>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat02 ping tomcat01</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ping: tomcat01: Name or service not known</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 如何可以解决呢？</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 通过--link既可以解决网络连通问题</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -d -P  --name tomcat03 --link tomcat02 tomcat</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">3a2bcaba804c5980d94d168457c436fbd139820be2ee77246888f1744e6bb473</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker ps</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                     NAMES</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">3a2bcaba804c        tomcat              &quot;catalina.sh run&quot;   4 seconds ago       Up 3 seconds        0.0.0.0:32772-&gt;8080/tcp   tomcat03</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">f22ed47ed1be        tomcat              &quot;catalina.sh run&quot;   57 minutes ago      Up 57 minutes       0.0.0.0:32771-&gt;8080/tcp   tomcat02</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">9d97f93401a0        tomcat              &quot;catalina.sh run&quot;   About an hour ago   Up About an hour    0.0.0.0:32770-&gt;8080/tcp   tomcat01</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat03 ping tomcat02</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PING tomcat02 (172.17.0.3) 56(84) bytes of data.</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from tomcat02 (172.17.0.3): icmp_seq=1 ttl=64 time=0.129 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from tomcat02 (172.17.0.3): icmp_seq=2 ttl=64 time=0.100 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from tomcat02 (172.17.0.3): icmp_seq=3 ttl=64 time=0.110 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from tomcat02 (172.17.0.3): icmp_seq=4 ttl=64 time=0.107 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 反向可以ping通吗？</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat02 ping tomcat03</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ping: tomcat03: Name or service not known</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>探究：inspect！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/pic04.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<p>其实这个 tomcat03 就是在本地配置了 tomcat02 的配置？</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat03 cat /etc/hosts</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">127.0.0.1   localhost</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">::1 localhost ip6-localhost ip6-loopback</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">fe00::0 ip6-localnet</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ff00::0 ip6-mcastprefix</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ff02::1 ip6-allnodes</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ff02::2 ip6-allrouters</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">172.17.0.3  tomcat02 f22ed47ed1be</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">172.17.0.4  3a2bcaba804c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>本质探究：--link 就是我们在 hosts 配置中增加了一个 172.17.0.3 tomcat02 f22ed47ed1be</p>
<p>我们现在玩 Docker 已经不建议使用--link 了！</p>
<p>自定义网络！不使用 Docker0！</p>
<p>Docker0 的问题：它不支持容器名链接访问！</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="自定义网络">自定义网络<a href="#自定义网络" class="hash-link" aria-label="Direct link to 自定义网络" title="Direct link to 自定义网络">​</a></h3>
<blockquote>
<p>查看所有的 docker 网络</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/20200814105640929.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<p><strong>网络模式</strong></p>
<p>bridge： 桥接模式，桥接 docker 默认，自己创建的也是用 brdge 模式</p>
<p>none： 不配置网络</p>
<p>host： 和宿主机共享网络</p>
<p>container：容器网络连通！（用的少， 局限很大）</p>
<p><strong>测试</strong></p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"># 我们直接启动的命令默认有一个 --net bridge，而这个就是我们的docker0</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -P --name tomcat01 tomcat</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">docker run -d -P --name tomcat01 --net bridge tomcat</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># docker0特点，默认，容器名不能访问， --link可以打通连接！</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 我们可以自定义一个网络！</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># --driver bridge</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># --subnet 192.168.0.0/16 可以支持255*255个网络 192.168.0.2 ~ 192.168.255.254</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># --gateway 192.168.0.1</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">26a5afdf4805d7ee0a660b82244929a4226470d99a179355558dca35a2b983ec</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker network ls</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">NETWORK ID          NAME                DRIVER              SCOPE</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">30d601788862        bridge              bridge              local</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">226019b14d91        host                host                local</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">26a5afdf4805        mynet               bridge              local</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">7496c014f74b        none                null                local</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>我们自己创建的网络就 ok 了！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/pic05.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<p>在自己创建的网络里面启动两个容器</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -d -P --name tomcat-net-01 --net mynet tomcat</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">0e85ebe6279fd23379d39b27b5f47c1e18f23ba7838637802973bf6449e22f5c</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker run -d -P --name tomcat-net-02 --net mynet tomcat</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">c6e462809ccdcebb51a4078b1ac8fdec33f1112e9e416406b606d0c9fb6f21b5</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker network inspect mynet</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Name&quot;: &quot;mynet&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Id&quot;: &quot;26a5afdf4805d7ee0a660b82244929a4226470d99a179355558dca35a2b983ec&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Created&quot;: &quot;2020-08-14T11:12:40.553433163+08:00&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Scope&quot;: &quot;local&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;EnableIPv6&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;IPAM&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Driver&quot;: &quot;default&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Options&quot;: {},</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Config&quot;: [</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            ]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Internal&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Attachable&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Ingress&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;ConfigFrom&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;Network&quot;: &quot;&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;ConfigOnly&quot;: false,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Containers&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;0e85ebe6279fd23379d39b27b5f47c1e18f23ba7838637802973bf6449e22f5c&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;Name&quot;: &quot;tomcat-net-01&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;EndpointID&quot;: &quot;576ce5c0f5860a5aab5e487a805da9d72f41a409c460f983c0bd341dd75d83ac&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:02&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;IPv4Address&quot;: &quot;192.168.0.2/16&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;IPv6Address&quot;: &quot;&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            &quot;c6e462809ccdcebb51a4078b1ac8fdec33f1112e9e416406b606d0c9fb6f21b5&quot;: {</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;Name&quot;: &quot;tomcat-net-02&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;EndpointID&quot;: &quot;81ecbc4fe26e49855fe374f2d7c00d517b11107cc91a174d383ff6be37d25a30&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:03&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;IPv4Address&quot;: &quot;192.168.0.3/16&quot;,</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                &quot;IPv6Address&quot;: &quot;&quot;</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        },</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Options&quot;: {},</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        &quot;Labels&quot;: {}</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 再次拼连接</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat-net-01 ping 192.168.0.3</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PING 192.168.0.3 (192.168.0.3) 56(84) bytes of data.</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from 192.168.0.3: icmp_seq=1 ttl=64 time=0.113 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from 192.168.0.3: icmp_seq=2 ttl=64 time=0.093 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">^C</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">--- 192.168.0.3 ping statistics ---</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">2 packets transmitted, 2 received, 0% packet loss, time 999ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">rtt min/avg/max/mdev = 0.093/0.103/0.113/0.010 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 现在不使用 --link也可以ping名字了！</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat-net-01 ping tomcat-net-02</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PING tomcat-net-02 (192.168.0.3) 56(84) bytes of data.</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=1 ttl=64 time=0.068 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=2 ttl=64 time=0.096 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from tomcat-net-02.mynet (192.168.0.3): icmp_seq=3 ttl=64 time=0.094 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">我们自定义的网络docker都已经帮我们维护好了对应的关系，推荐我们平时这样使用网络</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">好处：</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">redis - 不同的集群使用不同的网络，保证集群时安全和健康的</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">mysql - 不同的集群使用不同的网络，保证集群时安全和健康的</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="网络连通">网络连通<a href="#网络连通" class="hash-link" aria-label="Direct link to 网络连通" title="Direct link to 网络连通">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/pic06.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<p>测试打通 tomcat01 和 mynet</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/pic07.png" alt="在这里插入图片描述" class="img_ev3q"></p>
<div class="language-perl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-perl codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"># 连通ok</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat01 ping tomcat-net-01</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PING tomcat-net-01 (192.168.0.2) 56(84) bytes of data.</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq=1 ttl=64 time=0.100 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">64 bytes from tomcat-net-01.mynet (192.168.0.2): icmp_seq=2 ttl=64 time=0.085 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">^C</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">--- tomcat-net-01 ping statistics ---</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">2 packets transmitted, 2 received, 0% packet loss, time 1000ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">rtt min/avg/max/mdev = 0.085/0.092/0.100/0.012 ms</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"># 依旧无法连通，没有connect</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">[root@iZ2zeg4ytp0whqtmxbsqiiZ ~]# docker exec -it tomcat02 ping tomcat-net-01</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ping: tomcat-net-01: Name or service not known</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>结论：假设要跨网络 操作别人，就要使用 docker network connect 连通.....!</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="springboot-打包微服务项目上-docker">springboot 打包微服务项目上 docker<a href="#springboot-打包微服务项目上-docker" class="hash-link" aria-label="Direct link to springboot 打包微服务项目上 docker" title="Direct link to springboot 打包微服务项目上 docker">​</a></h2>
<ol>
<li>
<p>构建 springboot 项目</p>
<p>我们这里新建一个 deockerbootDemo</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/34656ca270b6745721d6539dbed36b5d.png" alt="image-20211107211729453" class="img_ev3q"></p>
<p>写一个 controller 返回一个 hello 即可</p>
<p>之后去安装一个 docker 的插件，可以用 idea 发布到 docker</p>
</li>
<li>
<p>打包应用</p>
</li>
<li>
<p>编写 dockerFile</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">FROM java:8</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">COPY *.jar /app.jar</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">CMD[&quot;------serverprot:8080&quot;]</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">EXPOSE 8080</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">ENTRYPOINT [&quot;java&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>构建镜像</p>
<p>将文件上传到 服务器的 dockertest/diea 文件夹中</p>
<p><code>运行dokcer bulid -t name .</code>即可构建镜像</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/07f708ad57e747715e6af683fadb41d0.png" alt="image-20211107213720789" class="img_ev3q"></p>
</li>
<li>
<p>发布运行</p>
</li>
</ol>
<p>之后我们创建容器</p>
<div class="language-shell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"> docker run -d -P --name hyc-springboot-web hycboot</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/490cb2bffd21f99c327a973c1ce4f6d4.png" alt="image-20211107213537801" class="img_ev3q"></p>
<p>以后我们就只需要，给别人一个镜像即可，</p>
<p>要是我们要很多个镜像，我们该怎么用？</p>
<p>docker 进阶预告 ：</p>
<ol>
<li>Docker compose</li>
<li>Docker Swarm</li>
<li>CI/DI jenkins</li>
</ol></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Java/Java 8 更新的新特性 （函数式接口 lambda stream option）"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Java8 新特性</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#docker-概述" class="table-of-contents__link toc-highlight">docker 概述</a><ul><li><a href="#docker-为什么出现" class="table-of-contents__link toc-highlight">docker 为什么出现？</a></li></ul></li><li><a href="#docker-的历史和作用" class="table-of-contents__link toc-highlight">Docker 的历史和作用</a></li><li><a href="#docker-安装" class="table-of-contents__link toc-highlight">Docker 安装</a><ul><li><a href="#docker-的组成结构" class="table-of-contents__link toc-highlight">Docker 的组成结构</a></li><li><a href="#安装-docker" class="table-of-contents__link toc-highlight">安装 Docker</a></li><li><a href="#阿里云的容器加速" class="table-of-contents__link toc-highlight">阿里云的容器加速</a></li><li><a href="#回顾-hello-world-的完整过程" class="table-of-contents__link toc-highlight">回顾 hello world 的完整过程</a></li><li><a href="#底层原理" class="table-of-contents__link toc-highlight">底层原理</a></li></ul></li><li><a href="#docker-的常用命令" class="table-of-contents__link toc-highlight">Docker 的常用命令</a><ul><li><a href="#帮助命令" class="table-of-contents__link toc-highlight">帮助命令</a></li><li><a href="#镜像命令" class="table-of-contents__link toc-highlight">镜像命令</a></li><li><a href="#容器命令" class="table-of-contents__link toc-highlight">容器命令</a></li><li><a href="#常用的其他命令" class="table-of-contents__link toc-highlight">常用的其他命令</a></li><li><a href="#小结" class="table-of-contents__link toc-highlight">小结</a></li><li><a href="#练习" class="table-of-contents__link toc-highlight">练习</a></li><li><a href="#nginx" class="table-of-contents__link toc-highlight">nginx</a></li><li><a href="#tomcat" class="table-of-contents__link toc-highlight">tomcat</a></li><li><a href="#可视化" class="table-of-contents__link toc-highlight">可视化</a></li></ul></li><li><a href="#docker-镜像讲解" class="table-of-contents__link toc-highlight">Docker 镜像讲解</a><ul><li><a href="#镜像是什么" class="table-of-contents__link toc-highlight">镜像是什么</a></li><li><a href="#docker-镜像加载原理" class="table-of-contents__link toc-highlight">Docker 镜像加载原理</a></li><li><a href="#分层理解" class="table-of-contents__link toc-highlight">分层理解</a></li><li><a href="#commit-镜像" class="table-of-contents__link toc-highlight">COMMIT 镜像</a></li></ul></li><li><a href="#容器数据卷" class="table-of-contents__link toc-highlight">容器数据卷</a><ul><li><a href="#什么是容器的数据卷" class="table-of-contents__link toc-highlight">什么是容器的数据卷</a></li><li><a href="#使用数据卷" class="table-of-contents__link toc-highlight">使用数据卷</a></li><li><a href="#实战安装-mysql" class="table-of-contents__link toc-highlight">实战安装 mysql</a></li><li><a href="#具名挂载和匿名挂载" class="table-of-contents__link toc-highlight">具名挂载和匿名挂载</a></li><li><a href="#初识-dockerfile" class="table-of-contents__link toc-highlight">初识 dockerfile</a></li><li><a href="#数据卷容器" class="table-of-contents__link toc-highlight">数据卷容器</a></li><li><a href="#结论" class="table-of-contents__link toc-highlight">结论：</a></li></ul></li><li><a href="#dockerfile" class="table-of-contents__link toc-highlight">dockerfile</a><ul><li><a href="#dockerfile-介绍" class="table-of-contents__link toc-highlight">dockerfile 介绍</a></li><li><a href="#dockerfile-构建过程" class="table-of-contents__link toc-highlight">DockerFile 构建过程</a></li><li><a href="#dockerfile-的指令" class="table-of-contents__link toc-highlight">Dockerfile 的指令</a></li><li><a href="#实战测试" class="table-of-contents__link toc-highlight">实战测试</a></li><li><a href="#实战-tomcat" class="table-of-contents__link toc-highlight">实战 tomcat</a></li><li><a href="#发布" class="table-of-contents__link toc-highlight">发布</a></li></ul></li><li><a href="#docker-网络" class="table-of-contents__link toc-highlight">docker 网络</a><ul><li><a href="#认识-docker-网络" class="table-of-contents__link toc-highlight">认识 docker 网络</a></li><li><a href="#小结-1" class="table-of-contents__link toc-highlight">小结</a></li><li><a href="#--link" class="table-of-contents__link toc-highlight">--link</a></li><li><a href="#自定义网络" class="table-of-contents__link toc-highlight">自定义网络</a></li><li><a href="#网络连通" class="table-of-contents__link toc-highlight">网络连通</a></li></ul></li><li><a href="#springboot-打包微服务项目上-docker" class="table-of-contents__link toc-highlight">springboot 打包微服务项目上 docker</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">  来自冷环渊的技术支持与文档创作 @2025</div></div></div></footer></div>
</body>
</html>