<!doctype html>
<html lang="cn" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Java/搜索引擎 _ Elasticsearch" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Elasticsearch | 小冷の代码世界</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://doomwatcher2004.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://doomwatcher2004.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://doomwatcher2004.github.io/docs/Java/搜索引擎 _ Elasticsearch"><meta data-rh="true" property="og:locale" content="cn"><meta data-rh="true" name="docusaurus_locale" content="cn"><meta data-rh="true" name="docsearch:language" content="cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Elasticsearch | 小冷の代码世界"><meta data-rh="true" name="description" content="我们搜做 ： 冷环渊，可以看到有关冷环渊的一些信息，"><meta data-rh="true" property="og:description" content="我们搜做 ： 冷环渊，可以看到有关冷环渊的一些信息，"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doomwatcher2004.github.io/docs/Java/搜索引擎 _ Elasticsearch"><link data-rh="true" rel="alternate" href="https://doomwatcher2004.github.io/docs/Java/搜索引擎 _ Elasticsearch" hreflang="cn"><link data-rh="true" rel="alternate" href="https://doomwatcher2004.github.io/docs/Java/搜索引擎 _ Elasticsearch" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.15cbc4ab.css">
<script src="/assets/js/runtime~main.4abb65a5.js" defer="defer"></script>
<script src="/assets/js/main.4b99896e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="小冷の代码世界" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="小冷の代码世界" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">小冷の代码世界</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Java/Docker 快速入门">Java知识库</a><a class="navbar__item navbar__link" href="/docs/Web/JavaScript 高级">前端知识库</a><a class="navbar__item navbar__link" href="/docs/Godot/">Godot游戏开发</a><a class="navbar__item navbar__link" href="/docs/finish/finishRpc">Finish系列手写中间件</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Doomwatcher2004" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Docker 快速入门">Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Java 8 更新的新特性 （函数式接口 lambda stream option）">Java8 新特性</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Java后端进阶之路： JavaWeb">javaweb</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Mybatis">Mybatis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty+springboot实现IM即时通讯服务端">Netty+springboot实现IM即时通讯服务端</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty_HTTP文件列表服务器">Netty_HTTP文件列表服务器</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty_模拟Redis的客户端">Netty_模拟Redis的客户端</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Netty网络框架">Netty 网络框架</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Nginx">Nginx</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Redis 数据结构操作入门">Redis 数据结构操作入门</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Spring Aop 底层责任链思路实现">Spring Aop 底层责任链思路实现</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Spring5 Webflux 响应式编程">Spring5 Webflux</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/SpringBoot 解决企业级复杂性简化开发的神奇">微服务阶段</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/SpringCloud Alibaba">springCloudAlibaba</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/SpringCloud Netflix">springcloud2020</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/Spring内置MVC框架：SpringMVC">SpringMVC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/mybatis plus">mybatis plus</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/redis问题的常见解决方案">redis问题的常见解决方案</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/六道入门树题目带你走入树结构的世界">六道入门树题目带你走入树结构的世界</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/分布式项目中锁的应用（本地锁-redis【setnx】-redisson-springcache）">分布式项目中锁的应用（本地锁-redis【setnx】-redisson-springcache）</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/多线程进阶 JUC并发编程">多线程进阶 JUC 并发编程</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/大前端进阶（ES6）">ES6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/快速入门RabbitMQ并且加入项目实战">快速入门RabbitMQ并且加入项目实战</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/快速入门分布式系统与Dubbo+zookeeper">分布式系统简述：</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/掌握极简服务器开发的优秀框架 ：Spring">Spring</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/Java/搜索引擎 _ Elasticsearch">Elasticsearch</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/数据结构与算法">数据结构与算法</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/理解IOC 手写springIOC">Spring 手撕 IOC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/简易aiweb">Java入门Spring AI应用开发</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/线程池详解与异步任务编排使用案例">线程池详解与异步任务编排使用案例</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/通透百万数据秒级排序  快速排序">通透百万数据秒级排序  快速排序</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/阿里淘系单点登录中心">阿里淘系单点登录中心</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Java/高并发秒杀系统">高并发秒杀系统</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Elasticsearch</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Elasticsearch</h1></header>
<p>我们搜做 ： 冷环渊，可以看到有关冷环渊的一些信息，</p>
<p>那么这个是怎么做到的呢？，往常我们都是用</p>
<p>SQL : like %冷环渊% 但是数据量一旦变大了，就会变慢，这个时候用索引， 也是只能快一些</p>
<p>这个时候 Elasticsearch 就是帮助我们解决问题的关键人物</p>
<p>他专注于搜索 ： 百度，github，淘宝等搜索都能看到他的影子</p>
<p>我们下面会通过以下去完成对 es 的学习</p>
<ol>
<li>认识一个人</li>
<li>看看同种类的搜索引擎的区别</li>
<li>安装</li>
<li>生态圈</li>
<li>IK 分词器</li>
<li>RestFul 操作</li>
<li>RestFul CRUD</li>
<li>SpingBoot 继承 ES(从原理开始分析)</li>
<li>实战 ： 爬虫爬取数据！</li>
<li>模拟全文检索</li>
</ol>
<p>以后只要，需要用到搜索，就可以使用 ES ， 建议基于大数据的情况下</p>
<h1>聊聊这个人 Doug Cutting</h1>
<p>1998 年 9 月 4 日，Google 公司在美国硅谷成立。正如大家所知，它是一家做 ==搜索==引擎起家的公司。</p>
<p>学大数据 首先就是 hadoop</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/456bfb43a8a2ef28b7e2def71945f4f9.png" alt="图片" class="img_ev3q"></p>
<p>无独有偶，一位名叫<strong>Doug Cutting</strong>的美国工程师，也迷上了搜索引擎。他做了一个用于文本搜索的函数库（姑且理解为软件的功能组件），命名为<strong>Lucene</strong>。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/9dd6dafabd7643500a09a490848988a2.png" alt="图片" class="img_ev3q"></p>
<p>左为 Doug Cutting，右为 Lucene 的 LOGO</p>
<p>Lucene 是用 JAVA 写成的，目标是为各种中小型应用软件加入全文检索功能。因为好用而且开源（代码公开），非常受程序员们的欢迎。</p>
<p>早期的时候，这个项目被发布在 Doug Cutting 的个人网站和 SourceForge（一个开源软件网站）。后来，2001 年底，Lucene 成为<strong>Apache 软件基金会</strong>jakarta 项目的一个子项目。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/4386b0e6c0b5bbc1f380e472b6ba05de.png" alt="图片" class="img_ev3q"></p>
<p>Apache 软件基金会，搞 IT 的应该都认识</p>
<p>2004 年，Doug Cutting 再接再励，在 Lucene 的基础上，和 Apache 开源伙伴 Mike Cafarella 合作，开发了一款可以代替当时的主流搜索的开源搜索引擎，命名为<strong>Nutch</strong>。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/552797da2721d6bd619e8d6bdbca8350.png" alt="图片" class="img_ev3q"></p>
<p>Nutch 是一个建立在 Lucene 核心之上的网页搜索应用程序，可以下载下来直接使用。它在 Lucene 的基础上加了网络爬虫和一些网页相关的功能，目的就是从一个简单的站内检索推广到全球网络的搜索上，就像 Google 一样。</p>
<p>Nutch 在业界的影响力比 Lucene 更大。</p>
<p>大批网站采用了 Nutch 平台，大大降低了技术门槛，使低成本的普通计算机取代高价的 Web 服务器成为可能。甚至有一段时间，在硅谷有了一股用 Nutch 低成本创业的潮流。</p>
<p>随着时间的推移，无论是 Google 还是 Nutch，都面临搜索对象“体积”不断增大的问题。</p>
<p>尤其是 Google，作为互联网搜索引擎，需要存储大量的网页，并不断优化自己的搜索算法，提升搜索效率。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/405893b04d771584da546a0120e65a90.png" alt="图片" class="img_ev3q"></p>
<p>Google 搜索栏</p>
<p>在这个过程中，Google 确实找到了不少好办法，并且无私地分享了出来。</p>
<p>2003 年，Google 发表了一篇技术学术论文，公开介绍了自己的谷歌文件系统<strong>GFS（Google File System）</strong>。这是 Google 公司为了存储海量搜索数据而设计的专用文件系统。</p>
<p>第二年，也就是 2004 年，Doug Cutting 基于 Google 的 GFS 论文，实现了<strong>分布式文件存储系统</strong>，并将它命名为<strong>NDFS（Nutch Distributed File System）</strong>。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d809f94344d6729864556bd67ff13a15.png" alt="图片" class="img_ev3q"></p>
<p>还是 2004 年，Google 又发表了一篇技术学术论文，介绍自己的<strong>MapReduce 编程模型</strong>。这个编程模型，用于大规模数据集（大于 1TB）的并行分析运算。</p>
<p>第二年（2005 年），Doug Cutting 又基于 MapReduce，在 Nutch 搜索引擎实现了该功能。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/53282dc311457475afd967937c99f816.png" alt="图片" class="img_ev3q"></p>
<p>2006 年，当时依然很厉害的<strong>Yahoo（雅虎）公司</strong>，招安了 Doug Cutting。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/31fc0fd4a240d94195980326fe322c63.png" alt="图片" class="img_ev3q"></p>
<p>这里要补充说明一下雅虎招安 Doug 的背景：2004 年之前，作为互联网开拓者的雅虎，是使用 Google 搜索引擎作为自家搜索服务的。在 2004 年开始，雅虎放弃了 Google，开始自己研发搜索引擎。所以。。。</p>
<p>加盟 Yahoo 之后，Doug Cutting 将 NDFS 和 MapReduce 进行了升级改造，并重新命名为<strong>Hadoop</strong>（NDFS 也改名为 HDFS，Hadoop Distributed File System）。</p>
<p>这个，就是后来大名鼎鼎的大数据框架系统——Hadoop 的由来。而 Doug Cutting，则被人们称为<strong>Hadoop 之父</strong>。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/268b0308715091a6bd3214cc252d6c17.png" alt="图片" class="img_ev3q"></p>
<p>Hadoop 这个名字，实际上是 Doug Cutting 他儿子的黄色玩具大象的名字。所以，Hadoop 的 Logo，就是一只奔跑的黄色大象。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/2c449c1cc7caded6119ff4ee0a1e8112.png" alt="图片" class="img_ev3q"></p>
<p>我们继续往下说。</p>
<p>还是 2006 年，Google 又发论文了。</p>
<p>这次，它们介绍了自己的<strong>BigTable</strong>。这是一种分布式数据存储系统，一种用来处理海量数据的非关系型数据库。</p>
<p>Doug Cutting 当然没有放过，在自己的 hadoop 系统里面，引入了 BigTable，并命名为<strong>HBase</strong>。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/1610ce30da72164883bb06eb599ca0e4.png" alt="图片" class="img_ev3q"></p>
<p>好吧，反正就是紧跟 Google 时代步伐，你出什么，我学什么。</p>
<p>所以，Hadoop 的核心部分，基本上都有 Google 的影子。</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/466c6b59b70c09eec9294081a2c07645.png" alt="图片" class="img_ev3q"></p>
<p>2008 年 1 月，Hadoop 成功上位，正式成为 Apache 基金会的顶级项目。</p>
<p>同年 2 月，Yahoo 宣布建成了一个拥有 1 万个内核的 Hadoop 集群，并将自己的搜索引擎产品部署在上面。</p>
<p>7 月，Hadoop 打破世界纪录，成为最快排序 1TB 数据的系统，用时 209 秒。</p>
<p>此后，Hadoop 便进入了高速发展期，直至现在。</p>
<blockquote>
<p>回到主题</p>
</blockquote>
<p>Lucene 是一套信息检索工具包，jar 包 不好含搜索引擎系统‘</p>
<p>包含 : 索引结构，读写索引工具 排序，搜索规则 。。。 工具类</p>
<p><strong>Lucene 和 ES 的关系：</strong></p>
<p>ES 是居于 Lucene 做了封装和增强 （我们上手就会感到十分的简单）</p>
<h1>ElasticSearch 概述</h1>
<p>Elaticsearch，简称为 es， es 是一个开源的<strong>高扩展</strong>的<strong>分布式全文检索引擎</strong>，它可以近乎<strong>实时的存储、检索数据</strong>；本身扩展性很好，可以扩展到上百台服务器，处理 PB 级别（大数据时代）的数据。es 也使用 Java 开发并使用 Lucene 作为其核心来实现所有索引和搜索的功能，但是它的目的是通过简单的<strong>RESTful API</strong>来隐藏 Lucene 的复杂性，从而让全文搜索变得简单。</p>
<p>据国际权威的数据库产品评测机构 DB Engines 的统计，在 2016 年 1 月，ElasticSearch 已超过 Solr 等，<strong>成为排名第一的搜索引擎类应用。</strong></p>
<p><strong>关键字就是：</strong></p>
<ul>
<li>实时</li>
<li>分布式</li>
<li>大数据</li>
<li>速度快</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="es-和-solr-的差别">ES 和 solr 的差别<a href="#es-和-solr-的差别" class="hash-link" aria-label="Direct link to ES 和 solr 的差别" title="Direct link to ES 和 solr 的差别">​</a></h2>
<p>架构选择！！！</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="elasticsearch-简介">Elasticsearch 简介<a href="#elasticsearch-简介" class="hash-link" aria-label="Direct link to Elasticsearch 简介" title="Direct link to Elasticsearch 简介">​</a></h3>
<p>Elasticsearch 是一个实时分布式搜索和分析引擎。它让你以前所未有的速度处理大数据成为可能。</p>
<p>它用于<strong>全文搜索、结构化搜索、分析</strong>以及将这三者混合使用：</p>
<p>维基百科使用 Elasticsearch 提供全文搜索并高亮关键字，以及输入实时搜索(search-asyou-type)和搜索纠错(did-you-mean)等搜索建议功能。</p>
<p>英国卫报使用 Elasticsearch 结合用户日志和社交网络数据提供给他们的编辑以实时的反馈，以便及时了解公众对新发表的文章的回应。</p>
<p>StackOverflow 结合全文搜索与地理位置查询，以及 more-like-this 功能来找到相关的问题和答案。</p>
<p>Github 使用 Elasticsearch 检索 1300 亿行的代码。</p>
<p>但是 Elasticsearch 不仅用于大型企业，它还让像 DataDog 以及 Klout 这样的创业公司将最初的想法变成可扩展的解决方案。</p>
<p>Elasticsearch 可以在你的笔记本上运行，也可以在数以百计的服务器上处理 PB 级别的数据 。</p>
<p>Elasticsearch 是一个基于 Apache Lucene(TM)的开源搜索引擎。无论在开源还是专有领域，Lucene 可以被认为是迄今为止最先进、性能最好的、功能最全的搜索引擎库。</p>
<p>但是，Lucene 只是一个库。想要使用它，你必须使用 Java 来作为开发语言并将其直接集成到你的应用中，更糟糕的是，Lucene 非常复杂，你需要深入了解检索的相关知识来理解它是如何工作的。</p>
<p>Elasticsearch 也使用 Java 开发并使用 Lucene 作为其核心来实现所有索引和搜索的功能，但是它的目的是通过简单的<strong>RESTful API</strong>来隐藏 Lucene 的复杂性，从而让全文搜索变得简单。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solr-简介">Solr 简介<a href="#solr-简介" class="hash-link" aria-label="Direct link to Solr 简介" title="Direct link to Solr 简介">​</a></h3>
<p>Solr 是 Apache 下的一个顶级开源项目，采用 Java 开发，它是基于 Lucene 的全文搜索服务器。Solr 提供了比 Lucene 更为丰富的查询语言，同时实现了可配置、可扩展，并对索引、搜索性能进行了优化</p>
<p>Solr 可以独立运行，运行在 Jetty、Tomcat 等这些 Servlet 容器中，Solr 索引的实现方法很简单，<strong>用 POST 方法向 Solr 服务器发送一个描述 Field 及其内容的 XML 文档，Solr 根据 xml 文档添加、删除、更新索引</strong>。Solr 搜索只需要发送 HTTP GET 请求，然后对 Solr 返回 Xml、json 等格式的查询结果进行解析，组织页面布局。Solr 不提供构建 UI 的功能，Solr 提供了一个管理界面，通过管理界面可以查询 Solr 的配置和运行情况。</p>
<p>solr 是基于 lucene 开发企业级搜索服务器，实际上就是封装了 lucene。</p>
<p>Solr 是一个独立的企业级搜索应用服务器，它对外提供类似于 Web-service 的 API 接口。用户可以通过 http 请求，向搜索引擎服务器提交一定格式的文件，生成索引；也可以通过提出查找请求，并得到返回结果。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lucene-简介">Lucene 简介<a href="#lucene-简介" class="hash-link" aria-label="Direct link to Lucene 简介" title="Direct link to Lucene 简介">​</a></h3>
<p>Lucene 是 apache 软件基金会 4 jakarta 项目组的一个子项目，是一个开放源代码的全文检索引擎工具包，但它不是一个完整的全文检索引擎，而是一个全文检索引擎的架构，提供了完整的查询引擎和索引引擎，部分文本分析引擎（英文与德文两种西方语言）。Lucene 的目的是为软件开发人员提供一个简单易用的工具包，以方便的在目标系统中实现全文检索的功能，或者是以此为基础建立起完整的全文检索引擎。Lucene 是一套用于全文检索和搜寻的开源程式库，由 Apache 软件基金会支持和提供。Lucene 提供了一个简单却强大的应用程式接口，能够做全文索引和搜寻。<strong>在 Java 开发环境里 Lucene 是一个成熟的免费开源工具。就其本身而言，Lucene 是当前以及最近几年最受欢迎的免费 Java 信息检索程序库</strong>。人们经常提到信息检索程序库，虽然与搜索引擎有关，但不应该将信息检索程序库与搜索引擎相混淆。</p>
<p>Lucene 是一个全文检索引擎的架构。那什么是全文搜索引擎？</p>
<p>全文搜索引擎是名副其实的搜索引擎，国外具代表性的有 Google、Fast/AllTheWeb、AltaVista、Inktomi、Teoma、WiseNut 等，国内著名的有百度（Baidu）。它们都是通过从互联网上提取的各个网站的信息（以网页文字为主）而建立的数据库中，检索与用户查询条件匹配的相关记录，然后按一定的排列顺序将结果返回给用户，因此他们是真正的搜索引擎。</p>
<p>从搜索结果来源的角度，全文搜索引擎又可细分为两种，一种是拥有自己的检索程序（Indexer），俗称“蜘蛛”（Spider）程序或“机器人”（Robot）程序，并自建网页数据库，搜索结果直接从自身的数据库中调用，如上面提到的 7 家引擎；另一种则是租用其他引擎的数据库，并按自定的格式排列搜索结果，如 Lycos 引擎。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="24-elasticsearch-和-solr-比较">2.4 Elasticsearch 和 Solr 比较<a href="#24-elasticsearch-和-solr-比较" class="hash-link" aria-label="Direct link to 2.4 Elasticsearch 和 Solr 比较" title="Direct link to 2.4 Elasticsearch 和 Solr 比较">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/dcc418c0b7ce7988914d5bd9005804fd.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/cb2a942cd4dca1ea9d5d74287d52f757.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/e9ca5f4579264e7844ea6d10819d041f.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/f51d5c29de4880b25fa529c713c4df43.png" alt="img" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="25-elasticsearch-vs-solr-总结">2.5 ElasticSearch vs Solr 总结<a href="#25-elasticsearch-vs-solr-总结" class="hash-link" aria-label="Direct link to 2.5 ElasticSearch vs Solr 总结" title="Direct link to 2.5 ElasticSearch vs Solr 总结">​</a></h3>
<ol>
<li>es 基本是开箱即用（解压就可以用 ! ），非常简单。Solr 安装略微复杂一丢丢！</li>
<li>Solr 利用 Zookeeper 进行分布式管理，而 Elasticsearch 自身带有分布式协调管理功能。</li>
<li>Solr 支持更多格式的数据，比如 JSON、XML、CSV，而 Elasticsearch 仅支持 json 文件格式。</li>
<li>Solr 官方提供的功能更多，而 Elasticsearch 本身更注重于核心功能，高级功能多有第三方插件提供，例如图形化界面需要 kibana 友好支撑~!</li>
<li>Solr 查询快，但更新索引时慢（即插入删除慢），用于电商等查询多的应用；
<ul>
<li>ES 建立索引快（即查询慢），<strong>即实时性查询快</strong>，用于 facebook 新浪等搜索。</li>
<li>Solr 是传统搜索应用的有力解决方案，但 Elasticsearch 更适用于新兴的实时搜索应用。</li>
</ul>
</li>
<li>Solr 比较成熟，有一个更大，更成熟的用户、开发和贡献者社区，而 Elasticsearch 相对开发维护者较少，更新太快，学习使用成本较高。（趋势！）</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="elasticsearch-安装">ElasticSearch 安装<a href="#elasticsearch-安装" class="hash-link" aria-label="Direct link to ElasticSearch 安装" title="Direct link to ElasticSearch 安装">​</a></h3>
<p>就注意一点，JDK 必须不能低于 1.8 最低要求就是 1.8</p>
<p>因为是 java 开发的，所以 ES 的版本和我们之后对应的 java 的和 jar 包的版本必须对应，且要保证 JDK 环境是正常的</p>
<blockquote>
<p>下载</p>
</blockquote>
<p>官网地址 ：<a href="https://www.elastic.co/cn/elasticsearch/" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/elasticsearch/</a></p>
<p>之后解压</p>
<blockquote>
<p>查看目录</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/c965a2aba4154e76e0c6c93699489097.png" alt="image-20211012172452263" class="img_ev3q"></p>
<p>熟悉目录</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">bin 启动文件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">config 配置文件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">	log4j2 日志文件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">	jvm.options jvm的运行参数，内存不足的一定要调整，默认是1g</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">	elasticsearch ES的一些配置 默认 : 9200</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">lib      相关架构</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">logs     日志！</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">modules  功能模块</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">pluginx  插件</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>启动查看</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/f9ab91bf677d5ae9042cd990ba080740.png" alt="image-20211012172959051" class="img_ev3q"></p>
<p>访问查看</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/a3d42dbb646a4fdfdd9d0ec267c2e84e.png" alt="image-20211012173225765" class="img_ev3q"></p>
<blockquote>
<p>安装可视化界面 ES head 插件</p>
</blockquote>
<p>下载地址 ： <a href="https://github.com/mobz/elasticsearch-head" target="_blank" rel="noopener noreferrer">https://github.com/mobz/elasticsearch-head</a></p>
<p>之后 配置环境和启动测试</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">npm install</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">npm run start</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>之后启动查看 <code>9100</code>端口</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/3ed47dff9f79638cb7507d72ea0993b4.png" alt="image-20211012175233838" class="img_ev3q"></p>
<p>但是发现，迟迟连接不上，这个是为什么？ 跨域问题，端口和端口的访问，于是我们要去配置 ES 的快去权限开启</p>
<div class="language-yml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yml codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token key atrule">http.cors.enabled</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> ture</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token key atrule">http.cors.allow-origin</span><span class="token punctuation" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;*&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>之后重启 es，连接成功</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/c3e3cc287edeca019572e1d115093465.png" alt="image-20211012231826957" class="img_ev3q"></p>
<p>我们可以创建索引体验一下，我们可以把索引，我们可以暂时当作是一个数据库（索引（库），表（库中的数据）），7.x 之后就淘汰了表，这个我们之后的学习就可以了解到哈哈</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/e366876ead2c461a7ecd1840eb1227bd.png" alt="image-20211012235329747" class="img_ev3q"></p>
<p>创建索引查看</p>
<blockquote>
<p>这个 head 就当作我们展示数据的工具</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/02f3c053cae6f6e14840a6f46d966504.png" alt="image-20211012235414619" class="img_ev3q"></p>
<p>这里面的 json 是没有格式化的，我们后续用 kabanna 做</p>
<blockquote>
<p>了解 ELK</p>
</blockquote>
<p>ELK 是 Elasticsearch、Logstash、Kibana 三大开源框架首字母大写简称。市面上也被成为 ElasticStack。其中 Elasticsearch 是一个基于 Lucene、分布式、通过 Restful 方式进行交互的近实时搜索平台框架。像类似百度、谷歌这种大数据全文搜索引擎的场景都可以使用 Elasticsearch 作为底层支持框架，可见 Elasticsearch 提供的搜索能力确实强大,市面上很多时候我们简称 Elasticsearch 为 es。Logstash 是 ELK 的中央数据流引擎，用于从不同目标（文件/数据存储/MQ）收集的不同格式数据，经过过滤后支持输出到不同目的地（文件/MQ/redis/elasticsearch/kafka 等）。Kibana 可以将 elasticsearch 的数据通过友好
的页面展示出来，提供实时分析的功能。</p>
<p>市面上很多开发只要提到 ELK 能够一致说出它是一个日志分析架构技术栈总称，但实际上 ELK 不仅仅适用于日志分析，它还可以支持其它任何数据分析和收集的场景，日志分析和收集只是更具有代表性。并非唯一性。</p>
<blockquote>
<p>安装 Kibana</p>
</blockquote>
<p>Kibana 是一个针对 Elasticsearch 的开源分析及可视化平台，用来搜索、查看交互存储在 Elasticsearch 索引中的数据。使用 Kibana，可以通过各种图表进行高级数据分析及展示。Kibana 让海量数据更容易理解。它操作简单，基于浏览器的用户界面可以快速创建仪表板（dashboard）实时显示 Elasticsearch 查询动态。设置 Kibana 非常简单。无需编码或者额外的基础架构，几分钟内就可以完成 Kibana 安装并启动 Elasticsearch 索引监测</p>
<p>日志数据清洗 ---&gt; 搜索，存储 ---&gt; 展示</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/655488a5d73730aa23120778d873a6fc.png" alt="image-20211013000032502" class="img_ev3q"></p>
<p>官网：<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.elastic.co%2Fcn%2Fkibana" target="_blank" rel="noopener noreferrer">https://www.elastic.co/cn/kibana</a></p>
<p>安装注意 ： klbanna 要和 ES 的版本要一致</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/c4733477b3ee83346f66f7f6eea361ca.png" alt="image-20211013000409136" class="img_ev3q"></p>
<p>下载完毕后，解压需要一些时间，是一个标准的工程</p>
<p>好处 ELK 基本上都是拆箱就可以用了</p>
<blockquote>
<p>启动测试</p>
</blockquote>
<p>查看解压目录</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/87d00c5ce3d853ca0b1d8e84859ad871.png" alt="image-20211013000935928" class="img_ev3q"></p>
<p>启动</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/80608b0b4002edb1e2f12499f84c936b.png" alt="image-20211013001948654" class="img_ev3q"></p>
<p>访问 5601 看看 i 情况</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/0c3f4de2d1656761cd2446f7f5a25676.png" alt="image-20211013002258522" class="img_ev3q"></p>
<p>开发工具 Post curl head 谷歌插件</p>
<p>之后我们的命令就在这个 klbanna 里面</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/090cf6fd67fbdae17fc9576f9f7cfa53.png" alt="image-20211013002723140" class="img_ev3q"></p>
<p>这个时候，全英文就让我们很难受，klbanna 也提供了国际化，这个项目十分的优秀</p>
<p>配置汉化</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/6860cc05410ee2673e34be0e2b37abfc.png" alt="image-20211013003958185" class="img_ev3q"></p>
<p>之后重启 klbanna 就可以了</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="es-核心概念">ES 核心概念<a href="#es-核心概念" class="hash-link" aria-label="Direct link to ES 核心概念" title="Direct link to ES 核心概念">​</a></h2>
<ol>
<li>索引</li>
<li>字段类型（mapping）</li>
<li>文档（documents）</li>
</ol>
<blockquote>
<p>概述</p>
</blockquote>
<p>在前面的学习中，我们已经掌握了 es 是什么，同时也把 es 的服务已经安装启动，那么 es 是如何去存储数据，数据结构是什么，又是如何实现搜索的呢？我们先来聊聊 ElasticSearch 的相关概念吧！</p>
<p><strong>集群，节点，索引，类型，文档，分片，映射是什么？</strong></p>
<p>一切都是 json</p>
<blockquote>
<p>elasticsearch 是面向文档，关系行数据库 和 elasticsearch 客观的对比！一切都是 JSON！</p>
</blockquote>

























<table><thead><tr><th style="text-align:center">Relational DB</th><th style="text-align:center">Elasticsearch</th></tr></thead><tbody><tr><td style="text-align:center">数据库(database)</td><td style="text-align:center">索引(indices)</td></tr><tr><td style="text-align:center">表(tables)</td><td style="text-align:center">types</td></tr><tr><td style="text-align:center">行(rows)</td><td style="text-align:center">documents</td></tr><tr><td style="text-align:center">字段(columns)</td><td style="text-align:center">fields</td></tr></tbody></table>
<p>elasticsearch(集群)中可以包含多个索引(数据库)，每个索引中可以包含多个类型(表)，每个类型下又包含多 个文档(行)，每个文档中又包含多个字段(列)。</p>
<p><strong>物理设计：</strong></p>
<p>elasticsearch 在后台把每个索引划分成多个分片，每分分片可以在集群中的不同服务器间迁移</p>
<p>一个人就是一个集群！默认的集群名称就是 elaticsearh</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/15cc6a25c7b69d68e2dfdbabc416063c.png" alt="img" class="img_ev3q"></p>
<p><strong>逻辑设计：</strong></p>
<p>一个索引类型中，包含多个文档，比如说文档 1，文档 2。 当我们索引一篇文档时，可以通过这样的一各顺序找到 它: 索引 ▷ 类型 ▷ 文档 ID ，通过这个组合我们就能索引到某个具体的文档。 注意:ID 不必是整数，实际上它是个字 符串。</p>
<blockquote>
<p>文档</p>
</blockquote>
<p>就是我们的一条条数据</p>
<div class="language-undefined codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-undefined codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">user</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">1  zhangsan  18</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">2  kuangshen  3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>之前说 elasticsearch 是面向文档的，那么就意味着索引和搜索数据的最小单位是文档，elasticsearch 中，文档有几个 重要属性 :</p>
<ul>
<li>自我包含，一篇文档同时包含字段和对应的值，也就是同时包含 key:value！</li>
<li>可以是层次型的，一个文档中包含自文档，复杂的逻辑实体就是这么来的！ {就是一个 json 对象！fastjson 进行自动转换！}</li>
<li>灵活的结构，文档不依赖预先定义的模式，我们知道关系型数据库中，要提前定义字段才能使用，在 elasticsearch 中，对于字段是非常灵活的，有时候，我们可以忽略该字段，或者动态的添加一个新的字段。</li>
</ul>
<p>尽管我们可以随意的新增或者忽略某个字段，但是，每个字段的类型非常重要，比如一个年龄字段类型，可以是字符 串也可以是整形。因为 elasticsearch 会保存字段和类型之间的映射及其他的设置。这种映射具体到每个映射的每种类型，这也是为什么在 elasticsearch 中，类型有时候也称为映射类型。</p>
<blockquote>
<p>类型</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/f63f48704efb64fac2521bc4c7b84521.png" alt="img" class="img_ev3q"></p>
<p>类型是文档的逻辑容器，就像关系型数据库一样，表格是行的容器。 类型中对于字段的定义称为映射，比如 name 映 射为字符串类型。 我们说文档是无模式的，它们不需要拥有映射中所定义的所有字段，比如新增一个字段，那么 elasticsearch 是怎么做的呢?elasticsearch 会自动的将新字段加入映射，但是这个字段的不确定它是什么类型，elasticsearch 就开始猜，如果这个值是 18，那么 elasticsearch 会认为它是整形。 但是 elasticsearch 也可能猜不对， 所以最安全的方式就是提前定义好所需要的映射，这点跟关系型数据库殊途同归了，先定义好字段，然后再使用，别 整什么幺蛾子。</p>
<blockquote>
<p>索引</p>
</blockquote>
<p>就是数据库！</p>
<p>索引是映射类型的容器，elasticsearch 中的索引是一个非常大的文档集合。索引存储了映射类型的字段和其他设置。 然后它们被存储到了各个分片上了。 我们来研究下分片是如何工作的。</p>
<p>物理设计 ：节点和分片 如何工作</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/2e8e5e3c29425137c05a4ccb45385964.png" alt="img" class="img_ev3q"></p>
<p>一个集群至少有一个节点，而一个节点就是一个 elasricsearch 进程，节点可以有多个索引默认的，如果你创建索引，那么索引将会有个 5 个分片 ( primary shard ,又称主分片 ) 构成的，每一个主分片会有一个副本 ( replica shard ,又称复制分片 )</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d8c9ddc0a2a0638211094003f62db472.png" alt="img" class="img_ev3q"></p>
<p>上图是一个有 3 个节点的集群，可以看到主分片和对应的复制分片都不会在同一个节点内，这样有利于某个节点挂掉 了，数据也不至于丢失。 实际上，一个分片是一个 Lucene 索引，一个包含倒排索引的文件目录，<strong>倒排索引</strong>的结构使 得 elasticsearch 在不扫描全部文档的情况下，就能告诉你哪些文档包含特定的关键字。 不过，等等，倒排索引是什 么鬼?</p>
<blockquote>
<p>倒排索引</p>
</blockquote>
<p>elasticsearch 使用的是一种称为倒排索引的结构，采用 Lucene 倒排索作为底层。这种结构适用于快速的全文搜索， 一个索引由文档中所有不重复的列表构成，对于每一个词，都有一个包含它的文档列表。 例如，现在有两个文档， 每个文档包含如下内容：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">Study every day, good good up to forever  # 文档1包含的内容</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">To forever, study every day, good good up # 文档2包含的内容</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>为了创建倒排索引，我们首先要将每个文档拆分成独立的词(或称为词条或者 tokens)，然后创建一个包含所有不重 复的词条的排序列表，然后列出每个词条出现在哪个文档 :</p>




























































<table><thead><tr><th style="text-align:center">term</th><th style="text-align:center">doc_1</th><th style="text-align:center">doc_2</th></tr></thead><tbody><tr><td style="text-align:center">Study</td><td style="text-align:center">√</td><td style="text-align:center">x</td></tr><tr><td style="text-align:center">To</td><td style="text-align:center">x</td><td style="text-align:center">x</td></tr><tr><td style="text-align:center">every</td><td style="text-align:center">√</td><td style="text-align:center">√</td></tr><tr><td style="text-align:center">forever</td><td style="text-align:center">√</td><td style="text-align:center">√</td></tr><tr><td style="text-align:center">day</td><td style="text-align:center">√</td><td style="text-align:center">√</td></tr><tr><td style="text-align:center">study</td><td style="text-align:center">x</td><td style="text-align:center">√</td></tr><tr><td style="text-align:center">good</td><td style="text-align:center">√</td><td style="text-align:center">√</td></tr><tr><td style="text-align:center">every</td><td style="text-align:center">√</td><td style="text-align:center">√</td></tr><tr><td style="text-align:center">to</td><td style="text-align:center">√</td><td style="text-align:center">x</td></tr><tr><td style="text-align:center">up</td><td style="text-align:center">√</td><td style="text-align:center">√</td></tr></tbody></table>
<p>现在，我们试图搜索 to forever，只需要查看包含每个词条的文档 score</p>

























<table><thead><tr><th style="text-align:center">term</th><th style="text-align:center">doc_1</th><th style="text-align:center">doc_2</th></tr></thead><tbody><tr><td style="text-align:center">to</td><td style="text-align:center">√</td><td style="text-align:center">×</td></tr><tr><td style="text-align:center">forever</td><td style="text-align:center">√</td><td style="text-align:center">√</td></tr><tr><td style="text-align:center">total</td><td style="text-align:center">2</td><td style="text-align:center">1</td></tr></tbody></table>
<p>两个文档都匹配，但是第一个文档比第二个匹配程度更高。如果没有别的条件，现在，这两个包含关键字的文档都将返回。</p>
<p>再来看一个示例，比如我们通过博客标签来搜索博客文章。那么倒排索引列表就是这样的一个结构 :</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/60b7443dcbeee2cfa137b2a157378933.png" alt="img" class="img_ev3q"></p>
<p>如果要搜索含有 python 标签的文章，那相对于查找所有原始数据而言，查找倒排索引后的数据将会快的多。只需要 查看标签这一栏，然后获取相关的文章 ID 即可。完全过滤掉无关的所有数据，提高效率！</p>
<p>elasticsearch 的索引和 Lucene 的索引对比</p>
<p>在 elasticsearch 中， 索引 （库）这个词被频繁使用，这就是术语的使用。 在 elasticsearch 中，索引被分为多个分片，每份 分片是一个 Lucene 的索引。所以一个 elasticsearch 索引是由多个 Lucene 索引组成的。别问为什么，谁让 elasticsearch 使用 Lucene 作为底层呢! 如无特指，说起索引都是指 elasticsearch 的索引。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ik-分词器插件">IK 分词器插件<a href="#ik-分词器插件" class="hash-link" aria-label="Direct link to IK 分词器插件" title="Direct link to IK 分词器插件">​</a></h2>
<blockquote>
<p>什么是 IK 分词器？</p>
</blockquote>
<p>分词：即把一段中文或者别的划分成一个个的关键字，我们在搜索时候会把自己的信息进行分词，会把数据库中或者索引库中的数据进行分词，然后进行一个匹配操作，默认的中文分词是将每个字看成一个词，比如 “我爱狂神” 会被分为&quot;我&quot;,&quot;爱&quot;,&quot;狂&quot;,&quot;神&quot;，这显然是不符合要求的，所以我们需要安装中文分词器 ik 来解决这个问题。</p>
<p>如果要使用中文，建议使用 ik 分词器！</p>
<p>IK 提供了两个分词算法：ik_smart 和 ik_max_word，其中 ik_smart 为最少切分，ik_max_word 为最细粒度划分！</p>
<blockquote>
<p>安装</p>
</blockquote>
<ol>
<li>
<p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2Fmedcl%2Felasticsearch-analysis-ik" target="_blank" rel="noopener noreferrer">https://github.com/medcl/elasticsearch-analysis-ik</a></p>
</li>
<li>
<p>下载完毕之后，放入到我们的 elasticsearch 插件即可！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/5bf32c5fa7699045694cbdd701469ad3.png" alt="img" class="img_ev3q"></p>
</li>
<li>
<p>重启观察 ES，可以看到 ik 分词器被加载了！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/acced313bd2c09c785b47426ac6f26a0.png" alt="img" class="img_ev3q"></p>
</li>
<li>
<p>elasticsearch-plugin 可以通过这个命令来查看加载进来的插件</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/871ef3fdce0e8cf057afc22135f62c39.png" alt="img" class="img_ev3q"></p>
</li>
<li>
<p>使用 kibana 测试！</p>
</li>
</ol>
<blockquote>
<p>查看不同的分词效果</p>
</blockquote>
<p>其中 ik_smart 为最少切分</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/2d9f50fdd5a8770c18855e9ee5ffec38.png" alt="img" class="img_ev3q"></p>
<p>ik_max_word 为最细粒度划分！穷尽词库的可能！字典！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/fdc58ba80e6ddd33b58e02153e9324bd.png" alt="img" class="img_ev3q"></p>
<blockquote>
<p>我们输入 超级喜欢狂神说 Java</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d819cfb9c29a9d5cc2dbf4dc3c571bb3.png" alt="img" class="img_ev3q"></p>
<p>发现问题：狂神说被拆开了！</p>
<p>这种自己需要的词，需要自己加到我们的分词器的字典中！</p>
<blockquote>
<p>ik 分词器增加自己的配置！</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/db758074a89081438afc5e99fd2a128f.png" alt="img" class="img_ev3q"></p>
<p>重启 es，看细节！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/32028131e5a2b74aa2f3e63cdae47ff8.png" alt="img" class="img_ev3q"></p>
<p>再次测试一下狂神说，看下效果！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d77a61b9e93f4bcee60c57ef506ec8a7.png" alt="img" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rest-风格说明">Rest 风格说明<a href="#rest-风格说明" class="hash-link" aria-label="Direct link to Rest 风格说明" title="Direct link to Rest 风格说明">​</a></h2>
<p>一种软件架构风格，而不是标准，只是提供了一组设计原则和约束条件。它主要用于客户端和服务器交互类的软件。基于这个风格设计的软件可以更简洁，更有层次，更易于实现缓存等机制。</p>
<p>基本 Rest 命令说明：</p>








































<table><thead><tr><th style="text-align:center">method</th><th style="text-align:center">url 地址</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td style="text-align:center">PUT</td><td style="text-align:center">localhost:9200/索引名称/类型名称/文档 id</td><td style="text-align:center">创建文档（指定文档 id）</td></tr><tr><td style="text-align:center">POST</td><td style="text-align:center">localhost:9200/索引名称/类型名称</td><td style="text-align:center">创建文档（随机文档 id）</td></tr><tr><td style="text-align:center">POST</td><td style="text-align:center">localhost:9200/索引名称/类型名称/文档 id/_update</td><td style="text-align:center">修改文档</td></tr><tr><td style="text-align:center">DELETE</td><td style="text-align:center">localhost:9200/索引名称/类型名称/文档 id</td><td style="text-align:center">删除文档</td></tr><tr><td style="text-align:center">GET</td><td style="text-align:center">localhost:9200/索引名称/类型名称/文档 id</td><td style="text-align:center">查询文档通过文档 id</td></tr><tr><td style="text-align:center">POST</td><td style="text-align:center">localhost:9200/索引名称/类型名称/_search</td><td style="text-align:center">查询所有数据</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="关于索引的基本操作">关于索引的基本操作<a href="#关于索引的基本操作" class="hash-link" aria-label="Direct link to 关于索引的基本操作" title="Direct link to 关于索引的基本操作">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="创建一个索引">创建一个索引！<a href="#创建一个索引" class="hash-link" aria-label="Direct link to 创建一个索引！" title="Direct link to 创建一个索引！">​</a></h3>
<div class="language-restructuredtext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-restructuredtext codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">PUT /索引名/~类型名~/文档id</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">{请求体}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/ab073c8d60442c0ea415b25f7a8930ab.png" alt="img" class="img_ev3q"></p>
<p>完成了自动增加了索引！数据也成功的添加了，这就是我说大家在初期可以把它当做数据库学习的原因！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/de53fb457637fa05d622559879dc72d2.png" alt="img" class="img_ev3q"></p>
<p>那么 name 这个字段用不用指定类型呢。毕竟我们关系型数据库 是需要指定类型的啊 !</p>
<ul>
<li>字符串类型
text 、 keyword</li>
<li>数值类型
long, integer, short, byte, double, float, half_float, scaled_float</li>
<li>日期类型
date</li>
<li>布尔值类型
boolean</li>
<li>二进制类型
binary</li>
<li>等等.....</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="指定字段的类型">指定字段的类型<a href="#指定字段的类型" class="hash-link" aria-label="Direct link to 指定字段的类型" title="Direct link to 指定字段的类型">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/0261dcceae815d3796c154ec6873db4d.png" alt="img" class="img_ev3q"></p>
<p>获得这个规则！ 可以通过 GET 请求获取具体的信息！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/cf55b26e50b36dfb135c8fd444b5ddf2.png" alt="img" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="查看默认的信息">查看默认的信息<a href="#查看默认的信息" class="hash-link" aria-label="Direct link to 查看默认的信息" title="Direct link to 查看默认的信息">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/5eaf7a7c3facc8b837c307c814aa0358.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/71220a396a6ef80bc9d19fe2733b7b28.png" alt="img" class="img_ev3q"></p>
<p>如果自己的文档字段没有指定，那么 es 就会给我们默认配置字段类型！</p>
<p><strong>扩展</strong>： 通过命令 elasticsearch 索引情况！ 通过 get _cat/ 可以获得 es 的当前的很多信息！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d5b297f51526a86a3b0ffaa9c7dcf45c.png" alt="img" class="img_ev3q"></p>
<blockquote>
<p>修改 提交还是使用 PUT 即可！ 然后覆盖！最新办法！</p>
</blockquote>
<p>曾经！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/80674931ce66b18154b6e8771c2918e2.png" alt="img" class="img_ev3q"></p>
<p>现在的方法！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/06576487a2b13811acf1efa7bdb1f439.png" alt="img" class="img_ev3q"></p>
<blockquote>
<p>删除索引！</p>
</blockquote>
<p>通过 DELETE 命令实现删除、 根据你的请求来判断是删除索引还是删除文档记录！</p>
<p>使用 RESTFUL 风格是我们 ES 推荐大家使用的！</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="8-关于文档的基本操作重点">8. 关于文档的基本操作（重点）<a href="#8-关于文档的基本操作重点" class="hash-link" aria-label="Direct link to 8. 关于文档的基本操作（重点）" title="Direct link to 8. 关于文档的基本操作（重点）">​</a></h2>
<blockquote>
<p>基本操作</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="添加数据">添加数据<a href="#添加数据" class="hash-link" aria-label="Direct link to 添加数据" title="Direct link to 添加数据">​</a></h3>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">PUT /kuangshen/user/</span><span class="token number" style="color:#B5CEA8">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;狂神说&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;age&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">23</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;desc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;一顿操作猛如虎，一看工资2500&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;tags&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token string" style="color:#64748b">&quot;技术宅&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;温暖&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;直男&quot;</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/71d5646a9cd9bfd5037442b0c3310af8.png" alt="img" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="获取数据-get">获取数据 GET<a href="#获取数据-get" class="hash-link" aria-label="Direct link to 获取数据 GET" title="Direct link to 获取数据 GET">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/e74553219a098e8d406ac03e8ccb2ffc.png" alt="img" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="更新数据-put">更新数据 PUT<a href="#更新数据-put" class="hash-link" aria-label="Direct link to 更新数据 PUT" title="Direct link to 更新数据 PUT">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/29cb083675602f81d3ea6b78516eac7b.png" alt="img" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="post-_update--推荐使用这种更新方式">Post _update , 推荐使用这种更新方式！<a href="#post-_update--推荐使用这种更新方式" class="hash-link" aria-label="Direct link to Post _update , 推荐使用这种更新方式！" title="Direct link to Post _update , 推荐使用这种更新方式！">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/22601647cb713dc8c730702bb4e2c26c.png" alt="img" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="简单地搜索">简单地搜索！<a href="#简单地搜索" class="hash-link" aria-label="Direct link to 简单地搜索！" title="Direct link to 简单地搜索！">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">GET kuangshen/user/1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>简答的条件查询，可以根据默认的映射规则，产生基本的查询！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/c9f34770527f50bee202d0c21cef0340.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/edd0b196a7940ab5124503b70f83d609.png" alt="img" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="复杂操作搜索-select--排序分页高亮模糊查询精准查询">复杂操作搜索 select ( 排序，分页，高亮，模糊查询，精准查询！)<a href="#复杂操作搜索-select--排序分页高亮模糊查询精准查询" class="hash-link" aria-label="Direct link to 复杂操作搜索 select ( 排序，分页，高亮，模糊查询，精准查询！)" title="Direct link to 复杂操作搜索 select ( 排序，分页，高亮，模糊查询，精准查询！)">​</a></h3>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/714d09e49365e2d013072004d74741e6.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/3794826ebf59e86e55506bba82dfd4d1.png" alt="img" class="img_ev3q"></p>
<p>输出结果，不想要那么多！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/e66e8944f55e909fb7ab94f109039304.png" alt="img" class="img_ev3q"></p>
<p>我们之后使用 Java 操作 es ，所有的方法和对象就是这里面的 key！</p>
<blockquote>
<p>排序！</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/c28ddad904053d685fdedac14f4d32a4.png" alt="img" class="img_ev3q"></p>
<blockquote>
<p>分页查询！</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/4d90133929f7b5e7c472fbad2949f364.png" alt="img" class="img_ev3q"></p>
<p>数据下标还是从 0 开始的，和学的所有数据结构是一样的！</p>
<p>/search/{current}/{pagesize}</p>
<blockquote>
<p>布尔值查询</p>
</blockquote>
<p><strong>must （and）</strong>，所有的条件都要符合 where id = 1 and name = xxx</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/acba02235adc1a28d5c2b5b983f20d6d.png" alt="img" class="img_ev3q"></p>
<p><strong>should（or）</strong>，所有的条件都要符合 where id = 1 or name = xxx</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/ca665b555cafa50771712701d61aa85a.png" alt="img" class="img_ev3q"></p>
<p><strong>must_not （not）</strong></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/83c319e26928359c53602700d67751a7.png" alt="img" class="img_ev3q"></p>
<p><strong>过滤器 filter</strong></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/7899c7403b1dda75e0cae712d68c2bb7.png" alt="img" class="img_ev3q"></p>
<ul>
<li>gt 大于</li>
<li>gte 大于等于</li>
<li>lt 小于</li>
<li>lte 小于等于！</li>
</ul>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/008fc48005e59fa989ae3e1ef21dae6f.png" alt="img" class="img_ev3q"></p>
<blockquote>
<p>匹配多个条件！</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/ee4fe330b65c89193510dc229c63d08e.png" alt="img" class="img_ev3q"></p>
<blockquote>
<p>精确查询！</p>
</blockquote>
<p>term 查询是直接通过倒排索引指定的词条进程精确查找的！</p>
<p><strong>关于分词：</strong></p>
<ul>
<li>term ，直接查询精确的</li>
<li>match，会使用分词器解析！（先分析文档，然后在通过分析的文档进行查询！）</li>
</ul>
<p><strong>两个类型 <code>text</code> <code>keyword</code></strong></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/4e952e144678857d2e9ea78907875b8b.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d4d0b6106fe62bc8100b6ec115198b19.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/7ff87479eb14b8d58dae70425ec1ea5a.png" alt="img" class="img_ev3q"></p>
<blockquote>
<p>多个值匹配精确查询</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/5c15c2846d7bf2ff458f5ca74a6c0f53.png" alt="img" class="img_ev3q"></p>
<blockquote>
<p>高亮查询！</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/f851e637a750ba56d2ff04a5e2c1ea8d.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/2388c1859d4478f393caa7f6295d251c.png" alt="img" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="使用的命令">使用的命令<a href="#使用的命令" class="hash-link" aria-label="Direct link to 使用的命令" title="Direct link to 使用的命令">​</a></h3>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">PUT /test1/type1/</span><span class="token number" style="color:#B5CEA8">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;name&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;小冷&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;age&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PUT /test2</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;mappings&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;properties&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token property">&quot;age&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;long&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token property">&quot;birthDay&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;date&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET test2</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PUT /test3/_doc/</span><span class="token number" style="color:#B5CEA8">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;age&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token number" style="color:#B5CEA8">8</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;brith&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token string" style="color:#64748b">&quot;2004-02-08&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">POST /test3/_doc/</span><span class="token number" style="color:#B5CEA8">1</span><span class="token plain">/_update</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;doc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;小冷&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET test3</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PUT /lhy/user/</span><span class="token number" style="color:#B5CEA8">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;狂神说&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;age&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">23</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;desc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;一顿操作猛如虎，一看工资2500&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;tags&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token string" style="color:#64748b">&quot;技术宅&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;温暖&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;直男&quot;</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PUT /lhy/user/</span><span class="token number" style="color:#B5CEA8">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;法外狂徒张三&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;age&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">30</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;desc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;罗老师手下的得力干将&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;tags&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token string" style="color:#64748b">&quot;身体好&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;懂法律&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;难判刑&quot;</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PUT /lhy/user/</span><span class="token number" style="color:#B5CEA8">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;法外狂徒张三&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;age&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">19</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;desc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;罗老师手下的得力干将&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;tags&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token string" style="color:#64748b">&quot;身体好&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;懂法律&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;难判刑&quot;</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">POST /lhy/user/</span><span class="token number" style="color:#B5CEA8">2</span><span class="token plain">/_update</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;doc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">     </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;张三&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PUT /lhy/user/</span><span class="token number" style="color:#B5CEA8">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;狂神说前端&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;age&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">23</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;desc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;前端特效大杀手&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token property">&quot;tags&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token string" style="color:#64748b">&quot;游戏强&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;抗压强&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;007&quot;</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET /lhy/user/</span><span class="token number" style="color:#B5CEA8">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET lhy/user/_search?q=name</span><span class="token operator" style="color:#475569">:</span><span class="token plain">狂神说</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET lhy/user/_search</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token property">&quot;query&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;match&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;狂神&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token property">&quot;sort&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;age&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token property">&quot;order&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;asc&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token property">&quot;from&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">0</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token property">&quot;size&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#boolean</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET lhy/user/_search</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token property">&quot;query&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;bool&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;should&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;match&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;狂神说&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;match&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token property">&quot;age&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">23</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#没有什么，相当与 not</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET lhy/user/_search</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token property">&quot;query&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;bool&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;must_not&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;match&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;狂神说&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#过滤器filter 筛选</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET lhy/user/_search</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token property">&quot;query&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;bool&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;must&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;match&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;狂神说&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">]</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;filter&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;range&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token property">&quot;age&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">              </span><span class="token property">&quot;lt&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">20</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET lhy/user/_search</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token property">&quot;query&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;bool&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;must&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;match&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">          </span><span class="token property">&quot;tags&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;技术 男 身体 007&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#精确查询和text keyword 两种类型的细节</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PUT testdb</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;mappings&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;properties&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;text&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token property">&quot;desc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;type&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;keyword&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PUT testdb/_doc/</span><span class="token number" style="color:#B5CEA8">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token string" style="color:#64748b">&quot;小冷学java&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;desc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token string" style="color:#64748b">&quot;java真的是个好玩的语言&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">PUT testdb/_doc/</span><span class="token number" style="color:#B5CEA8">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token string" style="color:#64748b">&quot;小冷学java&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;desc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token string" style="color:#64748b">&quot;java真的是个好玩的语言2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET _analyze</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;analyzer&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;keyword&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;text&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;小冷&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET _analyze</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;analyzer&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;standard&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;text&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;小冷&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET testdb/_search</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;query&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;term&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;desc&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;java真的是个好玩的语言&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">#高亮查询</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">GET lhy/user/_search</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;query&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token property">&quot;match&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token string" style="color:#64748b">&quot;狂神&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token property">&quot;highlight&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token property">&quot;fields&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">      </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#475569">:</span><span class="token punctuation" style="color:#475569">{</span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="集成-springboot">集成 SpringBoot<a href="#集成-springboot" class="hash-link" aria-label="Direct link to 集成 SpringBoot" title="Direct link to 集成 SpringBoot">​</a></h2>
<blockquote>
<p>找官方文档！</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/14d476d1e6fe89683a356d1a0643c0ee.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/367bf254b2c5b1bcf67ba8adae045b8f.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/ddda031a7fe9d199c984519804a5f97a.png" alt="img" class="img_ev3q"></p>
<ol>
<li>
<p>找到原生的依赖</p>
<div class="language-xml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-xml codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">dependency</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">groupId</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">org.elasticsearch.client</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">groupId</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">artifactId</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">elasticsearch-rest-high-level-client</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">artifactId</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">  </span><span class="token tag punctuation" style="color:#475569">&lt;</span><span class="token tag" style="color:#0ea5e9">version</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain">7.6.2</span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">version</span><span class="token tag punctuation" style="color:#475569">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token tag punctuation" style="color:#475569">&lt;/</span><span class="token tag" style="color:#0ea5e9">dependency</span><span class="token tag punctuation" style="color:#475569">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>找对象</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/d9be4cc5965a355aaa78c400547cfd10.png" alt="img" class="img_ev3q"></p>
</li>
<li>
<p>分析这个类中的方法即可！</p>
</li>
</ol>
<blockquote>
<p>配置基本的项目</p>
</blockquote>
<p><strong>问题：一定要保证 我们的导入的依赖和我们的 es 版本一致</strong></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/30d5654d07f59f6f001b859d375a9dcf.png" alt="img" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/f35d0133ef329b80b40229ce9213a3fa.png" alt="img" class="img_ev3q"></p>
<p>源码中提供对象！</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/172037ba42cf77b56f894c2fda35ce7c.png" alt="img" class="img_ev3q"></p>
<p>虽然这里导入 3 个类，静态内部类，核心类就一个！</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token comment" style="color:#6A9955">/**</span><br></span><span class="token-line" style="color:#0f172a"><span class="token comment" style="color:#6A9955">* Elasticsearch rest client infrastructure configurations.</span><br></span><span class="token-line" style="color:#0f172a"><span class="token comment" style="color:#6A9955">*</span><br></span><span class="token-line" style="color:#0f172a"><span class="token comment" style="color:#6A9955">* @author Brian Clozel</span><br></span><span class="token-line" style="color:#0f172a"><span class="token comment" style="color:#6A9955">* @author Stephane Nicoll</span><br></span><span class="token-line" style="color:#0f172a"><span class="token comment" style="color:#6A9955">*/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">RestClientConfigurations</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Configuration</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">proxyBeanMethods </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">static</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">RestClientBuilderConfiguration</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// RestClientBuilder</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token annotation punctuation" style="color:#475569">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token annotation punctuation" style="color:#475569">@ConditionalOnMissingBean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">RestClientBuilder</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">elasticsearchRestClientBuilder</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">RestClientProperties</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                         properties</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                         </span><span class="token class-name" style="color:#0ea5e9">ObjectProvider</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics class-name" style="color:#0ea5e9">RestClientBuilderCustomizer</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token plain"> builderCustomizers</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token class-name" style="color:#0ea5e9">HttpHost</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> hosts </span><span class="token operator" style="color:#475569">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                properties</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getUris</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">stream</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">map</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">HttpHost</span><span class="token operator" style="color:#475569">::</span><span class="token function" style="color:#0e7490">create</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">toArray</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">HttpHost</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token operator" style="color:#475569">::</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token class-name" style="color:#0ea5e9">RestClientBuilder</span><span class="token plain"> builder </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">RestClient</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">builder</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">hosts</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token class-name" style="color:#0ea5e9">PropertyMapper</span><span class="token plain"> map </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">PropertyMapper</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">get</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            map</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">from</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">properties</span><span class="token operator" style="color:#475569">::</span><span class="token function" style="color:#0e7490">getUsername</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">whenHasText</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token keyword" style="color:#0c4a6e">to</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">username</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token operator" style="color:#475569">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token class-name" style="color:#0ea5e9">CredentialsProvider</span><span class="token plain"> credentialsProvider </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    </span><span class="token class-name" style="color:#0ea5e9">BasicCredentialsProvider</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token class-name" style="color:#0ea5e9">Credentials</span><span class="token plain"> credentials </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    </span><span class="token class-name" style="color:#0ea5e9">UsernamePasswordCredentials</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">properties</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getUsername</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                properties</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getPassword</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                credentialsProvider</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">setCredentials</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">AuthScope</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">ANY</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> credentials</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                builder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">setHttpClientConfigCallback</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    </span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">httpClientBuilder</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token operator" style="color:#475569">-&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    httpClientBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">setDefaultCredentialsProvider</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">credentialsProvider</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            builder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">setRequestConfigCallback</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">requestConfigBuilder</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token operator" style="color:#475569">-&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                map</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">from</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">properties</span><span class="token operator" style="color:#475569">::</span><span class="token function" style="color:#0e7490">getConnectionTimeout</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">whenNonNull</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">asInt</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">Duration</span><span class="token operator" style="color:#475569">::</span><span class="token function" style="color:#0e7490">toMill</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                                               is</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    </span><span class="token punctuation" style="color:#475569">.</span><span class="token keyword" style="color:#0c4a6e">to</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">requestConfigBuilder</span><span class="token operator" style="color:#475569">::</span><span class="token function" style="color:#0e7490">setConnectTimeout</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                map</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">from</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">properties</span><span class="token operator" style="color:#475569">::</span><span class="token function" style="color:#0e7490">getReadTimeout</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">whenNonNull</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">asInt</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">Duration</span><span class="token operator" style="color:#475569">::</span><span class="token function" style="color:#0e7490">toMillis</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    </span><span class="token punctuation" style="color:#475569">.</span><span class="token keyword" style="color:#0c4a6e">to</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">requestConfigBuilder</span><span class="token operator" style="color:#475569">::</span><span class="token function" style="color:#0e7490">setSocketTimeout</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> requestConfigBuilder</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            builderCustomizers</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">orderedStream</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">forEach</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">customizer</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token operator" style="color:#475569">-&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                       customizer</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">customize</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">builder</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Configuration</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">proxyBeanMethods </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@ConditionalOnClass</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">RestHighLevelClient</span><span class="token punctuation" style="color:#475569">.</span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">static</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">RestHighLevelClientConfiguration</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// RestHighLevelClient 高级客户端，也是我们这里要讲，后面项目会用到的客户端</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token annotation punctuation" style="color:#475569">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token annotation punctuation" style="color:#475569">@ConditionalOnMissingBean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">RestHighLevelClient</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">elasticsearchRestHighLevelClient</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">RestClientBuilder</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                             restClientBuilder</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">RestHighLevelClient</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">restClientBuilder</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token annotation punctuation" style="color:#475569">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token annotation punctuation" style="color:#475569">@ConditionalOnMissingBean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">RestClient</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">elasticsearchRestClient</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">RestClientBuilder</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                           </span><span class="token class-name" style="color:#0ea5e9">ObjectProvider</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics class-name" style="color:#0ea5e9">RestHighLevelClient</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token plain"> restHighLevelClient</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token class-name" style="color:#0ea5e9">RestHighLevelClient</span><span class="token plain"> client </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> restHighLevelClient</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getIfUnique</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">client </span><span class="token operator" style="color:#475569">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">null</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getLowLevelClient</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">build</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Configuration</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">proxyBeanMethods </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">static</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">RestClientFallbackConfiguration</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// RestClient 普通的客户端！</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token annotation punctuation" style="color:#475569">@Bean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token annotation punctuation" style="color:#475569">@ConditionalOnMissingBean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">RestClient</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">elasticsearchRestClient</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">RestClientBuilder</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> builder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">build</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>具体的 Api 测试！</p>
</blockquote>
<ol>
<li>创建索引</li>
<li>判断索引是否存在</li>
<li>删除索引</li>
<li>创建文档</li>
<li>crud 文档！</li>
</ol>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token annotation punctuation" style="color:#475569">@SpringBootTest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">KuangshenEsApiApplicationTests</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 面向对象来操作</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Autowired</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Qualifier</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;restHighLevelClient&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">private</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">RestHighLevelClient</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 测试索引的创建 Request PUT kuang_index</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">void</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">testCreateIndex</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 1、创建索引请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">CreateIndexRequest</span><span class="token plain"> request </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">CreateIndexRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuang_index&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 2、客户端执行请求 IndicesClient,请求后获得响应</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">CreateIndexResponse</span><span class="token plain"> createIndexResponse </span><span class="token operator" style="color:#475569">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">indices</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">create</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">createIndexResponse</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 测试获取索引,判断其是否存在</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">void</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">testExistIndex</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">GetIndexRequest</span><span class="token plain"> request </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">GetIndexRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuang_index2&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">boolean</span><span class="token plain"> exists </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">indices</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">exists</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain">                                      </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">exists</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 测试删除索引</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">void</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">testDeleteIndex</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">DeleteIndexRequest</span><span class="token plain"> request </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">DeleteIndexRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuang_index&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 删除</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">AcknowledgedResponse</span><span class="token plain"> delete </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">indices</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">delete</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                              </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">delete</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">isAcknowledged</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 测试添加文档</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">void</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">testAddDocument</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 创建对象</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">User</span><span class="token plain"> user </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">User</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;狂神说&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">3</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 创建请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">IndexRequest</span><span class="token plain"> request </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IndexRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuang_index&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 规则 put /kuang_index/_doc/1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        request</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">id</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;1&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        request</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">timeout</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">TimeValue</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">timeValueSeconds</span><span class="token punctuation" style="color:#475569">(</span><span class="token number" style="color:#B5CEA8">1</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        request</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">timeout</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;1s&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 将我们的数据放入请求 json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        request</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">source</span><span class="token punctuation" style="color:#475569">(</span><span class="token constant" style="color:#0f172a">JSON</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">toJSONString</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">XContentType</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">JSON</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 客户端发送请求 , 获取响应的结果</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">IndexResponse</span><span class="token plain"> indexResponse </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">index</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                   </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">indexResponse</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">toString</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">indexResponse</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">status</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">// 对应我们命令返回的状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token constant" style="color:#0f172a">CREATED</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 获取文档，判断是否存在 get /index/doc/1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">void</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">testIsExists</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">GetRequest</span><span class="token plain"> getRequest </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">GetRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuang_index&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;1&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 不获取返回的 _source 的上下文了</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        getRequest</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">fetchSourceContext</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">FetchSourceContext</span><span class="token punctuation" style="color:#475569">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        getRequest</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">storedFields</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;_none_&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">boolean</span><span class="token plain"> exists </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">exists</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">getRequest</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">exists</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 获得文档的信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">void</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">testGetDocument</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">GetRequest</span><span class="token plain"> getRequest </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">GetRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuang_index&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;1&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">GetResponse</span><span class="token plain"> getResponse </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">get</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">getRequest</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                             </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">getResponse</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getSourceAsString</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">// 打印文档的内容</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">getResponse</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">// 返回的全部内容和命令式一样的</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 更新文档的信息</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">void</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">testUpdateRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">UpdateRequest</span><span class="token plain"> updateRequest </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">UpdateRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuang_index&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;1&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        updateRequest</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">timeout</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;1s&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">User</span><span class="token plain"> user </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">User</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;狂神说Java&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">18</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        updateRequest</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">doc</span><span class="token punctuation" style="color:#475569">(</span><span class="token constant" style="color:#0f172a">JSON</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">toJSONString</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">user</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">,</span><span class="token class-name" style="color:#0ea5e9">XContentType</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">JSON</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">UpdateResponse</span><span class="token plain"> updateResponse </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">update</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">updateRequest</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                      </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">updateResponse</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">status</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 删除文档记录</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">void</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">testDeleteRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">DeleteRequest</span><span class="token plain"> request </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">DeleteRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuang_index&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token string" style="color:#64748b">&quot;1&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        request</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">timeout</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;1s&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">DeleteResponse</span><span class="token plain"> deleteResponse </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">delete</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">request</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                      </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">deleteResponse</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">status</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 特殊的，真的项目一般都会批量插入数据！</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">void</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">testBulkRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">BulkRequest</span><span class="token plain"> bulkRequest </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">BulkRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        bulkRequest</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">timeout</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;10s&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">ArrayList</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics class-name" style="color:#0ea5e9">User</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token plain"> userList </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">ArrayList</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        userList</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">add</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">User</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuangshen1&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token number" style="color:#B5CEA8">3</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        userList</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">add</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">User</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuangshen2&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token number" style="color:#B5CEA8">3</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        userList</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">add</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">User</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuangshen3&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token number" style="color:#B5CEA8">3</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        userList</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">add</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">User</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;qinjiang1&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token number" style="color:#B5CEA8">3</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        userList</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">add</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">User</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;qinjiang1&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token number" style="color:#B5CEA8">3</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        userList</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">add</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">User</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;qinjiang1&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token number" style="color:#B5CEA8">3</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 批处理请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">int</span><span class="token plain"> i </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">0</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> i </span><span class="token operator" style="color:#475569">&lt;</span><span class="token plain"> userList</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">size</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> i</span><span class="token operator" style="color:#475569">++</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token comment" style="color:#6A9955">// 批量更新和批量删除，就在这里修改对应的请求就可以了</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            bulkRequest</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">add</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IndexRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuang_index&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">id</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;&quot;</span><span class="token operator" style="color:#475569">+</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">i</span><span class="token operator" style="color:#475569">+</span><span class="token number" style="color:#B5CEA8">1</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">source</span><span class="token punctuation" style="color:#475569">(</span><span class="token constant" style="color:#0f172a">JSON</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">toJSONString</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">userList</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">get</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">,</span><span class="token class-name" style="color:#0ea5e9">XContentType</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">JSON</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">BulkResponse</span><span class="token plain"> bulkResponse </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">bulk</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">bulkRequest</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">bulkResponse</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">hasFailures</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">// 是否失败，返回 false 代表</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        成功！</span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// 查询</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// SearchRequest 搜索请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// SearchSourceBuilder 条件构造</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// HighlightBuilder 构建高亮</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// TermQueryBuilder 精确查询</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// MatchAllQueryBuilder</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">// xxx QueryBuilder 对应我们刚才看到的命令！</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token annotation punctuation" style="color:#475569">@Test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">void</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">testSearch</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">SearchRequest</span><span class="token plain"> searchRequest </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">SearchRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;kuang_index&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 构建搜索条件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">SearchSourceBuilder</span><span class="token plain"> sourceBuilder </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">SearchSourceBuilder</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        sourceBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">highlighter</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token comment" style="color:#6A9955">// 查询条件，我们可以使用 QueryBuilders 工具来实现</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token comment" style="color:#6A9955">// QueryBuilders.termQuery 精确</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token comment" style="color:#6A9955">// QueryBuilders.matchAllQuery() 匹配所有</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token class-name" style="color:#0ea5e9">TermQueryBuilder</span><span class="token plain"> termQueryBuilder </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">QueryBuilders</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">termQuery</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;name&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                                        </span><span class="token string" style="color:#64748b">&quot;qinjiang1&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">//    MatchAllQueryBuilder matchAllQueryBuilder =</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">QueryBuilders</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">matchAllQuery</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        sourceBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">query</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">termQueryBuilder</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        sourceBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">timeout</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">TimeValue</span><span class="token punctuation" style="color:#475569">(</span><span class="token number" style="color:#B5CEA8">60</span><span class="token punctuation" style="color:#475569">,</span><span class="token class-name" style="color:#0ea5e9">TimeUnit</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">SECONDS</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        searchRequest</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">source</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">sourceBuilder</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">SearchResponse</span><span class="token plain"> searchResponse </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">search</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">searchRequest</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                                                      </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token constant" style="color:#0f172a">JSON</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">toJSONString</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">searchResponse</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getHits</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;=================================&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">SearchHit</span><span class="token plain"> documentFields </span><span class="token operator" style="color:#475569">:</span><span class="token plain"> searchResponse</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getHits</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getHits</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token class-name" style="color:#0ea5e9">System</span><span class="token punctuation" style="color:#475569">.</span><span class="token plain">out</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">println</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">documentFields</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getSourceAsMap</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="实战">实战<a href="#实战" class="hash-link" aria-label="Direct link to 实战" title="Direct link to 实战">​</a></h2>
<p>新建 jd boot 的项目</p>
<p>之后我们设置端口和把 thymeleaf 的缓存关掉，之后访问一下 index 查看</p>
<p><img decoding="async" loading="lazy" src="http://img.doomwatcher.cn/img/73d7dbc67cf2d708715bca72c35a3a32.png" alt="image-20211015013627150" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="爬虫">爬虫<a href="#爬虫" class="hash-link" aria-label="Direct link to 爬虫" title="Direct link to 爬虫">​</a></h3>
<blockquote>
<p>数据怎么来？从数据库获取，消息队列中获取，都可以成为数据源 爬虫！</p>
</blockquote>
<p>需要使用爬虫来爬取数据</p>
<div class="language-JAVA language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">   </span><span class="token keyword" style="color:#0c4a6e">public</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">List</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics">content</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">parseJD</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">String</span><span class="token plain"> keywords</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">//    https://search.jd.com/Search?keyword=java</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">// 前提需要联网</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">String</span><span class="token plain"> url </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;https://search.jd.com/Search?keyword=&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#475569">+</span><span class="token plain"> keywords </span><span class="token operator" style="color:#475569">+</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;&amp;enc=utf-8&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">//解析网页(jsoup返回document就是js,浏览器的Document对象)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">Document</span><span class="token plain"> document </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">Jsoup</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">parse</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">URL</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">30000</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">//所有我们再js中可以操作的,在这里都可以</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">Element</span><span class="token plain"> element </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> document</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getElementById</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;J_goodsList&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">//System.out.println(element.html());</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">//获取所有的li标签</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">Elements</span><span class="token plain"> li_elements </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> document</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getElementsByTag</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;li&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">ArrayList</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics">content</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token plain"> goodsList </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">ArrayList</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">Element</span><span class="token plain"> el </span><span class="token operator" style="color:#475569">:</span><span class="token plain"> li_elements</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">el</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">attr</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;class&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">equalsIgnoreCase</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;gl-item&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token class-name" style="color:#0ea5e9">String</span><span class="token plain"> img </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> el</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getElementsByTag</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;img&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">eq</span><span class="token punctuation" style="color:#475569">(</span><span class="token number" style="color:#B5CEA8">0</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">attr</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;data-lazy-img&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token class-name" style="color:#0ea5e9">String</span><span class="token plain"> price </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> el</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getElementsByClass</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;p-price&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">eq</span><span class="token punctuation" style="color:#475569">(</span><span class="token number" style="color:#B5CEA8">0</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">text</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token class-name" style="color:#0ea5e9">String</span><span class="token plain"> title </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> el</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getElementsByClass</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;p-name&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">eq</span><span class="token punctuation" style="color:#475569">(</span><span class="token number" style="color:#B5CEA8">0</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">text</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                content content </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">content</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                content</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">setTitle</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">title</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                content</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">setImg</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">img</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                content</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">setPrice</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">price</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                goodsList</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">add</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">content</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> goodsList</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="关键高亮">关键高亮<a href="#关键高亮" class="hash-link" aria-label="Direct link to 关键高亮" title="Direct link to 关键高亮">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token comment" style="color:#6A9955">//获取数据实现搜索高亮功能</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token keyword" style="color:#0c4a6e">public</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">List</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics class-name" style="color:#0ea5e9">Map</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics class-name" style="color:#0ea5e9">String</span><span class="token generics punctuation" style="color:#475569">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:#0ea5e9">Object</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#0e7490">getContentHighContent</span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">String</span><span class="token plain"> keywords</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">int</span><span class="token plain"> pageNo</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">int</span><span class="token plain"> pageSize</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">throws</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">IOException</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">pageNo </span><span class="token operator" style="color:#475569">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">1</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            pageNo </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token number" style="color:#B5CEA8">1</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">//条件搜索</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">SearchRequest</span><span class="token plain"> searchRequest </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">SearchRequest</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;jd_goods&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">SearchSourceBuilder</span><span class="token plain"> searchSourceBuilder </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">SearchSourceBuilder</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        searchSourceBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">from</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">pageNo</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        searchSourceBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">size</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">pageSize</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">//精确查询</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">MatchBoolPrefixQueryBuilder</span><span class="token plain"> queryBuilder </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">QueryBuilders</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">matchBoolPrefixQuery</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;title&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> keywords</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        searchSourceBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">query</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">queryBuilder</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        searchSourceBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">timeout</span><span class="token punctuation" style="color:#475569">(</span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">TimeValue</span><span class="token punctuation" style="color:#475569">(</span><span class="token number" style="color:#B5CEA8">60</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">TimeUnit</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">SECONDS</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">//配置高亮</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">HighlightBuilder</span><span class="token plain"> highlightBuilder </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">HighlightBuilder</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        highlightBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">field</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;title&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        highlightBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">requireFieldMatch</span><span class="token punctuation" style="color:#475569">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"> </span><span class="token comment" style="color:#6A9955">//多个高亮关闭</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        highlightBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">preTags</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;&lt;span style=&#x27;color:red &#x27;&gt;&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        highlightBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">postTags</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;&lt;/span&gt;&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        searchSourceBuilder</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">highlighter</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">highlightBuilder</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token comment" style="color:#6A9955">//执行搜索</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        searchRequest</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">source</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">searchSourceBuilder</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">SearchResponse</span><span class="token plain"> searchResponse </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">Client</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">search</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">searchRequest</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">RequestOptions</span><span class="token punctuation" style="color:#475569">.</span><span class="token constant" style="color:#0f172a">DEFAULT</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token class-name" style="color:#0ea5e9">ArrayList</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics class-name" style="color:#0ea5e9">Map</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics class-name" style="color:#0ea5e9">String</span><span class="token generics punctuation" style="color:#475569">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:#0ea5e9">Object</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token plain"> list </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">new</span><span class="token plain"> </span><span class="token class-name" style="color:#0ea5e9">ArrayList</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">SearchHit</span><span class="token plain"> documentFields </span><span class="token operator" style="color:#475569">:</span><span class="token plain"> searchResponse</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getHits</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getHits</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token comment" style="color:#6A9955">//解析高亮的字段</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token class-name" style="color:#0ea5e9">Map</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics class-name" style="color:#0ea5e9">String</span><span class="token generics punctuation" style="color:#475569">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:#0ea5e9">HighlightField</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token plain"> highlightFields </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> documentFields</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getHighlightFields</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token class-name" style="color:#0ea5e9">HighlightField</span><span class="token plain"> title </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> highlightFields</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">get</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;title&quot;</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token class-name" style="color:#0ea5e9">Map</span><span class="token generics punctuation" style="color:#475569">&lt;</span><span class="token generics class-name" style="color:#0ea5e9">String</span><span class="token generics punctuation" style="color:#475569">,</span><span class="token generics"> </span><span class="token generics class-name" style="color:#0ea5e9">Object</span><span class="token generics punctuation" style="color:#475569">&gt;</span><span class="token plain"> sourceAsMap </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> documentFields</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">getSourceAsMap</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token keyword" style="color:#0c4a6e">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">title </span><span class="token operator" style="color:#475569">!=</span><span class="token plain"> </span><span class="token keyword" style="color:#0c4a6e">null</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token comment" style="color:#6A9955">//取出全部的高亮title</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token class-name" style="color:#0ea5e9">Text</span><span class="token punctuation" style="color:#475569">[</span><span class="token punctuation" style="color:#475569">]</span><span class="token plain"> texts </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> title</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">fragments</span><span class="token punctuation" style="color:#475569">(</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token class-name" style="color:#0ea5e9">String</span><span class="token plain"> name </span><span class="token operator" style="color:#475569">=</span><span class="token plain"> </span><span class="token string" style="color:#64748b">&quot;&quot;</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token comment" style="color:#6A9955">//拼接成新字段</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token keyword" style="color:#0c4a6e">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">(</span><span class="token class-name" style="color:#0ea5e9">Text</span><span class="token plain"> text </span><span class="token operator" style="color:#475569">:</span><span class="token plain"> texts</span><span class="token punctuation" style="color:#475569">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#475569">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                    name </span><span class="token operator" style="color:#475569">+=</span><span class="token plain"> text</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                </span><span class="token comment" style="color:#6A9955">//如果需要就替换原来获取到的title</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">                sourceAsMap</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">put</span><span class="token punctuation" style="color:#475569">(</span><span class="token string" style="color:#64748b">&quot;title&quot;</span><span class="token punctuation" style="color:#475569">,</span><span class="token plain"> name</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">            list</span><span class="token punctuation" style="color:#475569">.</span><span class="token function" style="color:#0e7490">add</span><span class="token punctuation" style="color:#475569">(</span><span class="token plain">sourceAsMap</span><span class="token punctuation" style="color:#475569">)</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token punctuation" style="color:#475569">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">        </span><span class="token keyword" style="color:#0c4a6e">return</span><span class="token plain"> list</span><span class="token punctuation" style="color:#475569">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain">    </span><span class="token punctuation" style="color:#475569">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>之后我们需要用前端</p>
<p>vue 去解析 html</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#0f172a;--prism-background-color:#f1f5f9"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#0f172a;background-color:#f1f5f9"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token operator" style="color:#475569">&lt;</span><span class="token operator" style="color:#475569">!</span><span class="token operator" style="color:#475569">--</span><span class="token plain">标题</span><span class="token operator" style="color:#475569">--</span><span class="token operator" style="color:#475569">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token operator" style="color:#475569">&lt;</span><span class="token plain">p </span><span class="token keyword" style="color:#0c4a6e">class</span><span class="token operator" style="color:#475569">=</span><span class="token string" style="color:#64748b">&quot;productTitle&quot;</span><span class="token operator" style="color:#475569">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"> </span><span class="token operator" style="color:#475569">&lt;</span><span class="token plain">a v</span><span class="token operator" style="color:#475569">-</span><span class="token plain">html</span><span class="token operator" style="color:#475569">=</span><span class="token string" style="color:#64748b">&quot;result.title&quot;</span><span class="token operator" style="color:#475569">&gt;</span><span class="token operator" style="color:#475569">&lt;</span><span class="token operator" style="color:#475569">/</span><span class="token plain">a</span><span class="token operator" style="color:#475569">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#0f172a"><span class="token plain"></span><span class="token operator" style="color:#475569">&lt;</span><span class="token operator" style="color:#475569">/</span><span class="token plain">p</span><span class="token operator" style="color:#475569">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Java/掌握极简服务器开发的优秀框架 ：Spring"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Spring</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Java/数据结构与算法"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">数据结构与算法</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#es-和-solr-的差别" class="table-of-contents__link toc-highlight">ES 和 solr 的差别</a><ul><li><a href="#elasticsearch-简介" class="table-of-contents__link toc-highlight">Elasticsearch 简介</a></li><li><a href="#solr-简介" class="table-of-contents__link toc-highlight">Solr 简介</a></li><li><a href="#lucene-简介" class="table-of-contents__link toc-highlight">Lucene 简介</a></li><li><a href="#24-elasticsearch-和-solr-比较" class="table-of-contents__link toc-highlight">2.4 Elasticsearch 和 Solr 比较</a></li><li><a href="#25-elasticsearch-vs-solr-总结" class="table-of-contents__link toc-highlight">2.5 ElasticSearch vs Solr 总结</a></li><li><a href="#elasticsearch-安装" class="table-of-contents__link toc-highlight">ElasticSearch 安装</a></li></ul></li><li><a href="#es-核心概念" class="table-of-contents__link toc-highlight">ES 核心概念</a></li><li><a href="#ik-分词器插件" class="table-of-contents__link toc-highlight">IK 分词器插件</a></li><li><a href="#rest-风格说明" class="table-of-contents__link toc-highlight">Rest 风格说明</a></li><li><a href="#关于索引的基本操作" class="table-of-contents__link toc-highlight">关于索引的基本操作</a><ul><li><a href="#创建一个索引" class="table-of-contents__link toc-highlight">创建一个索引！</a></li><li><a href="#指定字段的类型" class="table-of-contents__link toc-highlight">指定字段的类型</a></li><li><a href="#查看默认的信息" class="table-of-contents__link toc-highlight">查看默认的信息</a></li></ul></li><li><a href="#8-关于文档的基本操作重点" class="table-of-contents__link toc-highlight">8. 关于文档的基本操作（重点）</a><ul><li><a href="#添加数据" class="table-of-contents__link toc-highlight">添加数据</a></li><li><a href="#获取数据-get" class="table-of-contents__link toc-highlight">获取数据 GET</a></li><li><a href="#更新数据-put" class="table-of-contents__link toc-highlight">更新数据 PUT</a></li><li><a href="#post-_update--推荐使用这种更新方式" class="table-of-contents__link toc-highlight">Post _update , 推荐使用这种更新方式！</a></li><li><a href="#简单地搜索" class="table-of-contents__link toc-highlight">简单地搜索！</a></li><li><a href="#复杂操作搜索-select--排序分页高亮模糊查询精准查询" class="table-of-contents__link toc-highlight">复杂操作搜索 select ( 排序，分页，高亮，模糊查询，精准查询！)</a></li><li><a href="#使用的命令" class="table-of-contents__link toc-highlight">使用的命令</a></li></ul></li><li><a href="#集成-springboot" class="table-of-contents__link toc-highlight">集成 SpringBoot</a></li><li><a href="#实战" class="table-of-contents__link toc-highlight">实战</a><ul><li><a href="#爬虫" class="table-of-contents__link toc-highlight">爬虫</a></li><li><a href="#关键高亮" class="table-of-contents__link toc-highlight">关键高亮</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">  来自冷环渊的技术支持与文档创作 @2025</div></div></div></footer></div>
</body>
</html>